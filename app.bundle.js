!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=22)}([function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return i});const n=(t,e,...r)=>{const n=document.createElement(t);if(void 0!==e){e.split(" ").forEach(t=>n.classList.add(t))}return r.forEach(t=>"string"!=typeof t?n.appendChild(t):n.appendChild(document.createTextNode(t))),n},i=t=>{return`#${t.map(t=>{const e=parseInt(t,10).toString(16);return 1===e.length?`0${e}`:e}).join("")}`}},function(t,e,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)i(r,n)&&(t[n]=r[n])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var a={arraySet:function(t,e,r,n,i){if(e.subarray&&t.subarray)t.set(e.subarray(r,r+n),i);else for(var a=0;a<n;a++)t[i+a]=e[r+a]},flattenChunks:function(t){var e,r,n,i,a,s;for(n=0,e=0,r=t.length;e<r;e++)n+=t[e].length;for(s=new Uint8Array(n),i=0,e=0,r=t.length;e<r;e++)a=t[e],s.set(a,i),i+=a.length;return s}},s={arraySet:function(t,e,r,n,i){for(var a=0;a<n;a++)t[i+a]=e[r+a]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,a)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(n)},function(t,e,r){t.exports=r.p+"60870f5639a83c0d5f6a9220e147ba28.png"},function(t,e,r){"use strict";var n=r(0),i=r(2),a=r.n(i);r(44),e.a=class{constructor(t){this.name=t}createLogoLink(){const t=Object(n.a)("img","logo");t.setAttribute("src",a.a);const e=Object(n.a)("a","logo__link",t);return e.setAttribute("href","/piskel-clone/"),e}createNavigation(){const t=Object(n.a)("a","button__nav create-sprite","Create Sprite");t.setAttribute("href","#");const e=Object(n.a)("div","button__nav sign-in","Sign in"),r=Object(n.a)("img","img-login"),i=Object(n.a)("span","user-name"),a=Object(n.a)("div","button__nav login",r,i),s=Object(n.a)("div","button__nav logout","Logout");return Object(n.a)("nav","main-nav",t,e,a,s)}setScripts(){const t=Object(n.a)("script");t.setAttribute("src","https://apis.google.com/js/platform.js"),t.setAttribute("async",""),t.setAttribute("defer","");const e=Object(n.a)("script");e.setAttribute("src","https://apis.google.com/js/api.js");const r=Object(n.a)("meta");r.setAttribute("name","google-signin-client_id"),r.setAttribute("content","650755710272-0c48fmokj47v815den93354ud4mfj4om.apps.googleusercontent.com");const i=Object(n.a)("div","g-signin2 signIn");return i.setAttribute("data-onsuccess","onSignIn"),document.querySelector(".main-nav").append(i),[t,r,e]}render(){const t=this.createLogoLink(),e=Object(n.a)("span","piskel-name",this.name),r=this.createNavigation(),i=Object(n.a)("header","main-header",t,e,r),a=Object(n.a)("main","main"),s=Object(n.a)("div","main__wrapper",i,a);document.body.append(s);const o=this.setScripts();document.head.append(...o)}}},function(t,e,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,r){"use strict";t.exports=function(t,e,r,n){for(var i=65535&t|0,a=t>>>16&65535|0,s=0;0!==r;){r-=s=r>2e3?2e3:r;do{a=a+(i=i+e[n++]|0)|0}while(--s);i%=65521,a%=65521}return i|a<<16|0}},function(t,e,r){"use strict";var n=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();t.exports=function(t,e,r,i){var a=n,s=i+r;t^=-1;for(var o=i;o<s;o++)t=t>>>8^a[255&(t^e[o])];return-1^t}},function(t,e,r){"use strict";var n=r(1),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var s=new n.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(t,e){if(e<65534&&(t.subarray&&a||!t.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var r="",s=0;s<e;s++)r+=String.fromCharCode(t[s]);return r}s[254]=s[254]=1,e.string2buf=function(t){var e,r,i,a,s,o=t.length,l=0;for(a=0;a<o;a++)55296==(64512&(r=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=t.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(i-56320),a++),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new n.Buf8(l),s=0,a=0;s<l;a++)55296==(64512&(r=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=t.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(i-56320),a++),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|63&r):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|63&r):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|63&r);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new n.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e},e.buf2string=function(t,e){var r,n,i,a,o=e||t.length,h=new Array(2*o);for(n=0,r=0;r<o;)if((i=t[r++])<128)h[n++]=i;else if((a=s[i])>4)h[n++]=65533,r+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&r<o;)i=i<<6|63&t[r++],a--;a>1?h[n++]=65533:i<65536?h[n++]=i:(i-=65536,h[n++]=55296|i>>10&1023,h[n++]=56320|1023&i)}return l(h,n)},e.utf8border=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;r>=0&&128==(192&t[r]);)r--;return r<0?e:0===r?e:r+s[t[r]]>e?r:e}},function(t,e,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,r){t.exports=function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){var n,i,a={}.hasOwnProperty,s=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};n=r(1).EventEmitter,r(2),i=function(t){function e(t){var e,n,i;for(n in this.running=!1,this.options={},this.frames=[],this.groups=new Map,this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),r)i=r[n],null==(e=this.options)[n]&&(e[n]=i)}var r,n;return function(t,e){function r(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,t),r={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1},n={delay:500,copy:!1},e.prototype.setOption=function(t,e){if(this.options[t]=e,null!=this._canvas&&("width"===t||"height"===t))return this._canvas[t]=e},e.prototype.setOptions=function(t){var e,r,n;for(e in r=[],t)a.call(t,e)&&(n=t[e],r.push(this.setOption(e,n)));return r},e.prototype.addFrame=function(t,e){var r,i,a;for(a in null==e&&(e={}),(r={}).transparent=this.options.transparent,n)r[a]=e[a]||n[a];if(null==this.options.width&&this.setOption("width",t.width),null==this.options.height&&this.setOption("height",t.height),"undefined"!=typeof ImageData&&null!==ImageData&&t instanceof ImageData)r.data=t.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?r.data=this.getContextData(t):r.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?r.data=this.getImageData(t):r.image=t}return(i=this.frames.length)>0&&r.data&&(this.groups.has(r.data)?this.groups.get(r.data).push(i):this.groups.set(r.data,[i])),this.frames.push(r)},e.prototype.render=function(){var t,e,r;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var t,e,r;for(r=[],t=0,e=this.frames.length;0<=e?t<e:t>e;0<=e?++t:--t)r.push(null);return r}.call(this),e=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(t=0,r=e;0<=r?t<r:t>r;0<=r?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},e.prototype.abort=function(){for(var t;null!=(t=this.activeWorkers.shift());)this.log("killing active worker"),t.terminate();return this.running=!1,this.emit("abort")},e.prototype.spawnWorkers=function(){var t,e,r;return t=Math.min(this.options.workers,this.frames.length),function(){r=[];for(var n=e=this.freeWorkers.length;e<=t?n<t:n>t;e<=t?n++:n--)r.push(n);return r}.apply(this).forEach(function(t){return function(e){var r;return t.log("spawning worker "+e),(r=new Worker(t.options.workerScript)).onmessage=function(e){return t.activeWorkers.splice(t.activeWorkers.indexOf(r),1),t.freeWorkers.push(r),t.frameFinished(e.data,!1)},t.freeWorkers.push(r)}}(this)),t},e.prototype.frameFinished=function(t,e){var r,n,i,a;if(this.finishedFrames++,e?(r=this.frames.indexOf(t),n=this.groups.get(t.data)[0],this.log("frame "+(r+1)+" is duplicate of "+n+" - "+this.activeWorkers.length+" active"),this.imageParts[r]={indexOfFirstInGroup:n}):(this.log("frame "+(t.index+1)+" finished - "+this.activeWorkers.length+" active"),this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t),!0===this.options.globalPalette&&!e&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(i=1,a=this.freeWorkers.length;1<=a?i<a:i>a;1<=a?++i:--i)this.renderNextFrame();return s.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},e.prototype.finishRendering=function(){var t,e,r,n,i,a,s,o,l,h,c,d,f,u,_,p,m,g,v,b;for(m=this.imageParts,i=a=0,h=m.length;a<h;i=++a)(e=m[i]).indexOfFirstInGroup&&(this.imageParts[i]=this.imageParts[e.indexOfFirstInGroup]);for(l=0,g=this.imageParts,s=0,c=g.length;s<c;s++)e=g[s],l+=(e.data.length-1)*e.pageSize+e.cursor;for(l+=e.pageSize-e.cursor,this.log("rendering finished - filesize "+Math.round(l/1e3)+"kb"),t=new Uint8Array(l),_=0,v=this.imageParts,o=0,d=v.length;o<d;o++)for(e=v[o],b=e.data,r=u=0,f=b.length;u<f;r=++u)p=b[r],t.set(p,_),_+=r===e.data.length-1?e.cursor:e.pageSize;return n=new Blob([t],{type:"image/gif"}),this.emit("finished",n,t)},e.prototype.renderNextFrame=function(){var t,e,r,n;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],(e=this.frames.indexOf(t))>0&&this.groups.has(t.data)&&this.groups.get(t.data)[0]!==e?void setTimeout(function(e){return function(){return e.frameFinished(t,!0)}}(this),0):(n=this.freeWorkers.shift(),r=this.getTask(t),this.log("starting frame "+(r.index+1)+" of "+this.frames.length),this.activeWorkers.push(n),n.postMessage(r))},e.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},e.prototype.getImageData=function(t){var e;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(e=this._canvas.getContext("2d")).setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},e.prototype.getTask=function(t){var e,r;if(e=this.frames.indexOf(t),r={index:e,last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:!0},null!=t.data)r.data=t.data;else if(null!=t.context)r.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");r.data=this.getImageData(t.image)}return r},e.prototype.log=function(t){if(this.options.debug)return console.log(t)},e}(n),t.exports=i},function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,s,o,l,h;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(a(r=this._events[t]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(i(r))for(o=Array.prototype.slice.call(arguments,1),h=r.slice(),s=h.length,l=0;l<s;l++)h[l].apply(this,o);return!0},r.prototype.addListener=function(t,e){var s;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(s=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,a,s,o;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,a=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(r)){for(o=s;o-- >0;)if(r[o]===e||r[o].listener&&r[o].listener===e){a=o;break}if(a<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(a,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[t]))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){var r,n,i,a,s;s=navigator.userAgent.toLowerCase(),a=navigator.platform.toLowerCase(),r=s.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],i="ie"===r[1]&&document.documentMode,(n={name:"version"===r[1]?r[3]:r[1],version:i||parseFloat("opera"===r[1]&&r[4]?r[4]:r[2]),platform:{name:s.match(/ip(?:ad|od|hone)/)?"ios":(s.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]}})[n.name]=!0,n[n.name+parseInt(n.version,10)]=!0,n.platform[n.platform.name]=!0,t.exports=n}])},function(t,e,r){(function(e){!function(){var e={};t.exports=e,function(t,e){t.toRGBA8=function(e){var r=e.width,n=e.height;if(null==e.tabs.acTL)return[t.toRGBA8.decodeImage(e.data,r,n,e).buffer];var i=[];null==e.frames[0].data&&(e.frames[0].data=e.data);for(var a,s=new Uint8Array(r*n*4),o=0;o<e.frames.length;o++){var l=e.frames[o],h=l.rect.x,c=l.rect.y,d=l.rect.width,f=l.rect.height,u=t.toRGBA8.decodeImage(l.data,d,f,e);if(0==o?a=u:0==l.blend?t._copyTile(u,d,f,a,r,n,h,c,0):1==l.blend&&t._copyTile(u,d,f,a,r,n,h,c,1),i.push(a.buffer),a=a.slice(0),0==l.dispose);else if(1==l.dispose)t._copyTile(s,d,f,a,r,n,h,c,0);else if(2==l.dispose){for(var _=o-1;2==e.frames[_].dispose;)_--;a=new Uint8Array(i[_]).slice(0)}}return i},t.toRGBA8.decodeImage=function(e,r,n,i){var a=r*n,s=t.decode._getBPP(i),o=Math.ceil(r*s/8),l=new Uint8Array(4*a),h=new Uint32Array(l.buffer),c=i.ctype,d=i.depth,f=t._bin.readUshort;if(6==c){var u=a<<2;if(8==d)for(var _=0;_<u;_++)l[_]=e[_];if(16==d)for(_=0;_<u;_++)l[_]=e[_<<1]}else if(2==c){var p=i.tabs.tRNS,m=-1,g=-1,v=-1;if(p&&(m=p[0],g=p[1],v=p[2]),8==d)for(_=0;_<a;_++){var b=3*_;l[C=_<<2]=e[b],l[C+1]=e[b+1],l[C+2]=e[b+2],l[C+3]=255,-1!=m&&e[b]==m&&e[b+1]==g&&e[b+2]==v&&(l[C+3]=0)}if(16==d)for(_=0;_<a;_++){b=6*_;l[C=_<<2]=e[b],l[C+1]=e[b+2],l[C+2]=e[b+4],l[C+3]=255,-1!=m&&f(e,b)==m&&f(e,b+2)==g&&f(e,b+4)==v&&(l[C+3]=0)}}else if(3==c){var w=i.tabs.PLTE,y=i.tabs.tRNS,k=y?y.length:0;if(1==d)for(var x=0;x<n;x++){var S=x*o,z=x*r;for(_=0;_<r;_++){var C=z+_<<2,L=3*(A=e[S+(_>>3)]>>7-((7&_)<<0)&1);l[C]=w[L],l[C+1]=w[L+1],l[C+2]=w[L+2],l[C+3]=A<k?y[A]:255}}if(2==d)for(x=0;x<n;x++)for(S=x*o,z=x*r,_=0;_<r;_++){C=z+_<<2,L=3*(A=e[S+(_>>2)]>>6-((3&_)<<1)&3);l[C]=w[L],l[C+1]=w[L+1],l[C+2]=w[L+2],l[C+3]=A<k?y[A]:255}if(4==d)for(x=0;x<n;x++)for(S=x*o,z=x*r,_=0;_<r;_++){C=z+_<<2,L=3*(A=e[S+(_>>1)]>>4-((1&_)<<2)&15);l[C]=w[L],l[C+1]=w[L+1],l[C+2]=w[L+2],l[C+3]=A<k?y[A]:255}if(8==d)for(_=0;_<a;_++){var A;C=_<<2,L=3*(A=e[_]);l[C]=w[L],l[C+1]=w[L+1],l[C+2]=w[L+2],l[C+3]=A<k?y[A]:255}}else if(4==c){if(8==d)for(_=0;_<a;_++){C=_<<2;var O=e[E=_<<1];l[C]=O,l[C+1]=O,l[C+2]=O,l[C+3]=e[E+1]}if(16==d)for(_=0;_<a;_++){var E;C=_<<2,O=e[E=_<<2];l[C]=O,l[C+1]=O,l[C+2]=O,l[C+3]=e[E+2]}}else if(0==c){m=i.tabs.tRNS?i.tabs.tRNS:-1;if(1==d)for(_=0;_<a;_++){var I=(O=255*(e[_>>3]>>7-(7&_)&1))==255*m?0:255;h[_]=I<<24|O<<16|O<<8|O}if(2==d)for(_=0;_<a;_++){I=(O=85*(e[_>>2]>>6-((3&_)<<1)&3))==85*m?0:255;h[_]=I<<24|O<<16|O<<8|O}if(4==d)for(_=0;_<a;_++){I=(O=17*(e[_>>1]>>4-((1&_)<<2)&15))==17*m?0:255;h[_]=I<<24|O<<16|O<<8|O}if(8==d)for(_=0;_<a;_++){I=(O=e[_])==m?0:255;h[_]=I<<24|O<<16|O<<8|O}if(16==d)for(_=0;_<a;_++){O=e[_<<1],I=f(e,_<<1)==m?0:255;h[_]=I<<24|O<<16|O<<8|O}}return l},t.decode=function(e){for(var r,n=new Uint8Array(e),i=8,a=t._bin,s=a.readUshort,o=a.readUint,l={tabs:{},frames:[]},h=new Uint8Array(n.length),c=0,d=0,f=[137,80,78,71,13,10,26,10],u=0;u<8;u++)if(n[u]!=f[u])throw"The input is not a PNG file!";for(;i<n.length;){var _=a.readUint(n,i);i+=4;var p=a.readASCII(n,i,4);if(i+=4,"IHDR"==p)t.decode._IHDR(n,i,l);else if("IDAT"==p){for(u=0;u<_;u++)h[c+u]=n[i+u];c+=_}else if("acTL"==p)l.tabs[p]={num_frames:o(n,i),num_plays:o(n,i+4)},r=new Uint8Array(n.length);else if("fcTL"==p){if(0!=d)(S=l.frames[l.frames.length-1]).data=t.decode._decompress(l,r.slice(0,d),S.rect.width,S.rect.height),d=0;var m={x:o(n,i+12),y:o(n,i+16),width:o(n,i+4),height:o(n,i+8)},g=s(n,i+22);g=s(n,i+20)/(0==g?100:g);var v={rect:m,delay:Math.round(1e3*g),dispose:n[i+24],blend:n[i+25]};l.frames.push(v)}else if("fdAT"==p){for(u=0;u<_-4;u++)r[d+u]=n[i+u+4];d+=_-4}else if("pHYs"==p)l.tabs[p]=[a.readUint(n,i),a.readUint(n,i+4),n[i+8]];else if("cHRM"==p){l.tabs[p]=[];for(u=0;u<8;u++)l.tabs[p].push(a.readUint(n,i+4*u))}else if("tEXt"==p){null==l.tabs[p]&&(l.tabs[p]={});var b=a.nextZero(n,i),w=a.readASCII(n,i,b-i),y=a.readASCII(n,b+1,i+_-b-1);l.tabs[p][w]=y}else if("iTXt"==p){null==l.tabs[p]&&(l.tabs[p]={});b=0;var k=i;b=a.nextZero(n,k);w=a.readASCII(n,k,b-k),n[k=b+1],n[k+1];k+=2,b=a.nextZero(n,k);a.readASCII(n,k,b-k);k=b+1,b=a.nextZero(n,k);a.readUTF8(n,k,b-k);k=b+1;y=a.readUTF8(n,k,_-(k-i));l.tabs[p][w]=y}else if("PLTE"==p)l.tabs[p]=a.readBytes(n,i,_);else if("hIST"==p){var x=l.tabs.PLTE.length/3;l.tabs[p]=[];for(u=0;u<x;u++)l.tabs[p].push(s(n,i+2*u))}else if("tRNS"==p)3==l.ctype?l.tabs[p]=a.readBytes(n,i,_):0==l.ctype?l.tabs[p]=s(n,i):2==l.ctype&&(l.tabs[p]=[s(n,i),s(n,i+2),s(n,i+4)]);else if("gAMA"==p)l.tabs[p]=a.readUint(n,i)/1e5;else if("sRGB"==p)l.tabs[p]=n[i];else if("bKGD"==p)0==l.ctype||4==l.ctype?l.tabs[p]=[s(n,i)]:2==l.ctype||6==l.ctype?l.tabs[p]=[s(n,i),s(n,i+2),s(n,i+4)]:3==l.ctype&&(l.tabs[p]=n[i]);else if("IEND"==p){var S;if(0!=d)(S=l.frames[l.frames.length-1]).data=t.decode._decompress(l,r.slice(0,d),S.rect.width,S.rect.height),d=0;l.data=t.decode._decompress(l,h,l.width,l.height);break}i+=_;a.readUint(n,i);i+=4}return delete l.compress,delete l.interlace,delete l.filter,l},t.decode._decompress=function(e,r,n,i){return 0==e.compress&&(r=t.decode._inflate(r)),0==e.interlace?r=t.decode._filterZero(r,e,0,n,i):1==e.interlace&&(r=t.decode._readInterlace(r,e)),r},t.decode._inflate=function(t){return e.inflate(t)},t.decode._readInterlace=function(e,r){for(var n=r.width,i=r.height,a=t.decode._getBPP(r),s=a>>3,o=Math.ceil(n*a/8),l=new Uint8Array(i*o),h=0,c=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],f=[8,8,8,4,4,2,2],u=[8,8,4,4,2,2,1],_=0;_<7;){for(var p=f[_],m=u[_],g=0,v=0,b=c[_];b<i;)b+=p,v++;for(var w=d[_];w<n;)w+=m,g++;var y=Math.ceil(g*a/8);t.decode._filterZero(e,r,h,g,v);for(var k=0,x=c[_];x<i;){for(var S=d[_],z=h+k*y<<3;S<n;){var C;if(1==a)C=(C=e[z>>3])>>7-(7&z)&1,l[x*o+(S>>3)]|=C<<7-((3&S)<<0);if(2==a)C=(C=e[z>>3])>>6-(7&z)&3,l[x*o+(S>>2)]|=C<<6-((3&S)<<1);if(4==a)C=(C=e[z>>3])>>4-(7&z)&15,l[x*o+(S>>1)]|=C<<4-((1&S)<<2);if(a>=8)for(var L=x*o+S*s,A=0;A<s;A++)l[L+A]=e[(z>>3)+A];z+=a,S+=m}k++,x+=p}g*v!=0&&(h+=v*(1+y)),_+=1}return l},t.decode._getBPP=function(t){return[1,null,3,1,2,null,4][t.ctype]*t.depth},t.decode._filterZero=function(e,r,n,i,a){var s=t.decode._getBPP(r),o=Math.ceil(i*s/8),l=t.decode._paeth;s=Math.ceil(s/8);for(var h=0;h<a;h++){var c=n+h*o,d=c+h+1,f=e[d-1];if(0==f)for(var u=0;u<o;u++)e[c+u]=e[d+u];else if(1==f){for(u=0;u<s;u++)e[c+u]=e[d+u];for(u=s;u<o;u++)e[c+u]=e[d+u]+e[c+u-s]&255}else if(0==h){for(u=0;u<s;u++)e[c+u]=e[d+u];if(2==f)for(u=s;u<o;u++)e[c+u]=255&e[d+u];if(3==f)for(u=s;u<o;u++)e[c+u]=e[d+u]+(e[c+u-s]>>1)&255;if(4==f)for(u=s;u<o;u++)e[c+u]=e[d+u]+l(e[c+u-s],0,0)&255}else{if(2==f)for(u=0;u<o;u++)e[c+u]=e[d+u]+e[c+u-o]&255;if(3==f){for(u=0;u<s;u++)e[c+u]=e[d+u]+(e[c+u-o]>>1)&255;for(u=s;u<o;u++)e[c+u]=e[d+u]+(e[c+u-o]+e[c+u-s]>>1)&255}if(4==f){for(u=0;u<s;u++)e[c+u]=e[d+u]+l(0,e[c+u-o],0)&255;for(u=s;u<o;u++)e[c+u]=e[d+u]+l(e[c+u-s],e[c+u-o],e[c+u-s-o])&255}}}return e},t.decode._paeth=function(t,e,r){var n=t+e-r,i=Math.abs(n-t),a=Math.abs(n-e),s=Math.abs(n-r);return i<=a&&i<=s?t:a<=s?e:r},t.decode._IHDR=function(e,r,n){var i=t._bin;n.width=i.readUint(e,r),r+=4,n.height=i.readUint(e,r),r+=4,n.depth=e[r],r++,n.ctype=e[r],r++,n.compress=e[r],r++,n.filter=e[r],r++,n.interlace=e[r],r++},t._bin={nextZero:function(t,e){for(;0!=t[e];)e++;return e},readUshort:function(t,e){return t[e]<<8|t[e+1]},writeUshort:function(t,e,r){t[e]=r>>8&255,t[e+1]=255&r},readUint:function(t,e){return 16777216*t[e]+(t[e+1]<<16|t[e+2]<<8|t[e+3])},writeUint:function(t,e,r){t[e]=r>>24&255,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r},readASCII:function(t,e,r){for(var n="",i=0;i<r;i++)n+=String.fromCharCode(t[e+i]);return n},writeASCII:function(t,e,r){for(var n=0;n<r.length;n++)t[e+n]=r.charCodeAt(n)},readBytes:function(t,e,r){for(var n=[],i=0;i<r;i++)n.push(t[e+i]);return n},pad:function(t){return t.length<2?"0"+t:t},readUTF8:function(e,r,n){for(var i,a="",s=0;s<n;s++)a+="%"+t._bin.pad(e[r+s].toString(16));try{i=decodeURIComponent(a)}catch(i){return t._bin.readASCII(e,r,n)}return i}},t._copyTile=function(t,e,r,n,i,a,s,o,l){for(var h=Math.min(e,i),c=Math.min(r,a),d=0,f=0,u=0;u<c;u++)for(var _=0;_<h;_++)if(s>=0&&o>=0?(d=u*e+_<<2,f=(o+u)*i+s+_<<2):(d=(-o+u)*e-s+_<<2,f=u*i+_<<2),0==l)n[f]=t[d],n[f+1]=t[d+1],n[f+2]=t[d+2],n[f+3]=t[d+3];else if(1==l){var p=t[d+3]*(1/255),m=t[d]*p,g=t[d+1]*p,v=t[d+2]*p,b=n[f+3]*(1/255),w=n[f]*b,y=n[f+1]*b,k=n[f+2]*b,x=1-p,S=p+b*x,z=0==S?0:1/S;n[f+3]=255*S,n[f+0]=(m+w*x)*z,n[f+1]=(g+y*x)*z,n[f+2]=(v+k*x)*z}else if(2==l){p=t[d+3],m=t[d],g=t[d+1],v=t[d+2],b=n[f+3],w=n[f],y=n[f+1],k=n[f+2];p==b&&m==w&&g==y&&v==k?(n[f]=0,n[f+1]=0,n[f+2]=0,n[f+3]=0):(n[f]=m,n[f+1]=g,n[f+2]=v,n[f+3]=p)}else if(3==l){p=t[d+3],m=t[d],g=t[d+1],v=t[d+2],b=n[f+3],w=n[f],y=n[f+1],k=n[f+2];if(p==b&&m==w&&g==y&&v==k)continue;if(p<220&&b>20)return!1}return!0},t.encode=function(e,r,n,i,a,s){null==i&&(i=0),null==s&&(s=!1);for(var o=new Uint8Array(e[0].byteLength*e.length+100),l=[137,80,78,71,13,10,26,10],h=0;h<8;h++)o[h]=l[h];var c=8,d=t._bin,f=t.crc.crc,u=d.writeUint,_=d.writeUshort,p=d.writeASCII,m=t.encode.compressPNG(e,r,n,i,s);u(o,c,13),p(o,c+=4,"IHDR"),u(o,c+=4,r),u(o,c+=4,n),o[c+=4]=m.depth,o[++c]=m.ctype,o[++c]=0,o[++c]=0,o[++c]=0,u(o,++c,f(o,c-17,17)),u(o,c+=4,1),p(o,c+=4,"sRGB"),o[c+=4]=1,u(o,++c,f(o,c-5,5)),c+=4;var g=e.length>1;if(g&&(u(o,c,8),p(o,c+=4,"acTL"),u(o,c+=4,e.length),u(o,c+=4,0),u(o,c+=4,f(o,c-12,12)),c+=4),3==m.ctype){u(o,c,3*(C=m.plte.length)),p(o,c+=4,"PLTE"),c+=4;for(h=0;h<C;h++){var v=3*h,b=m.plte[h],w=255&b,y=b>>8&255,k=b>>16&255;o[c+v+0]=w,o[c+v+1]=y,o[c+v+2]=k}if(u(o,c+=3*C,f(o,c-3*C-4,3*C+4)),c+=4,m.gotAlpha){u(o,c,C),p(o,c+=4,"tRNS"),c+=4;for(h=0;h<C;h++)o[c+h]=m.plte[h]>>24&255;u(o,c+=C,f(o,c-C-4,C+4)),c+=4}}for(var x=0,S=0;S<m.frames.length;S++){var z=m.frames[S];g&&(u(o,c,26),p(o,c+=4,"fcTL"),u(o,c+=4,x++),u(o,c+=4,z.rect.width),u(o,c+=4,z.rect.height),u(o,c+=4,z.rect.x),u(o,c+=4,z.rect.y),_(o,c+=4,a[S]),_(o,c+=2,1e3),o[c+=2]=z.dispose,o[++c]=z.blend,u(o,++c,f(o,c-30,30)),c+=4);var C,L=z.cimg;u(o,c,(C=L.length)+(0==S?0:4));var A=c+=4;p(o,c,0==S?"IDAT":"fdAT"),c+=4,0!=S&&(u(o,c,x++),c+=4);for(h=0;h<C;h++)o[c+h]=L[h];u(o,c+=C,f(o,A,c-A)),c+=4}return u(o,c,0),p(o,c+=4,"IEND"),u(o,c+=4,f(o,c-4,4)),c+=4,o.buffer.slice(0,c)},t.encode.compressPNG=function(e,r,n,i,a){for(var s=t.encode.compress(e,r,n,i,!1,a),o=0;o<e.length;o++){var l=s.frames[o],h=(l.rect.width,l.rect.height),c=l.bpl,d=l.bpp,f=new Uint8Array(h*c+h);l.cimg=t.encode._filterZero(l.img,h,d,c,f)}return s},t.encode.compress=function(e,r,n,i,a,s){null==s&&(s=!1);for(var o=6,l=8,h=4,c=255,d=0;d<e.length;d++)for(var f=new Uint8Array(e[d]),u=f.length,_=0;_<u;_+=4)c&=f[_+3];var p=255!=c,m={},g=[];if(0!=e.length&&(m[0]=0,g.push(0),0!=i&&i--),0!=i){var v=t.quantize(e,i,a);e=v.bufs;for(_=0;_<v.plte.length;_++){null==m[w=v.plte[_].est.rgba]&&(m[w]=g.length,g.push(w))}}else for(d=0;d<e.length;d++){var b=new Uint32Array(e[d]);for(u=b.length,_=0;_<u;_++){var w=b[_];if((_<r||w!=b[_-1]&&w!=b[_-r])&&null==m[w]&&(m[w]=g.length,g.push(w),g.length>=300))break}}var y=!!p&&a,k=g.length;k<=256&&0==s&&(l=k<=2?1:k<=4?2:k<=16?4:8,a&&(l=8),p=!0);var x=[];for(d=0;d<e.length;d++){var S=new Uint8Array(e[d]),z=new Uint32Array(S.buffer),C=0,L=0,A=r,O=n,E=0;if(0!=d&&!y){for(var I=a||1==d||2==x[x.length-2].dispose?1:2,q=0,j=1e9,T=0;T<I;T++){for(var R=new Uint8Array(e[d-1-T]),P=new Uint32Array(e[d-1-T]),D=r,N=n,F=-1,B=-1,U=0;U<n;U++)for(var M=0;M<r;M++){z[_=U*r+M]!=P[_]&&(M<D&&(D=M),M>F&&(F=M),U<N&&(N=U),U>B&&(B=U))}var Z=-1==F?1:(F-D+1)*(B-N+1);Z<j&&(j=Z,q=T,-1==F?(C=L=0,A=O=1):(C=D,L=N,A=F-D+1,O=B-N+1))}R=new Uint8Array(e[d-1-q]);1==q&&(x[x.length-1].dispose=2);var $=new Uint8Array(A*O*4);new Uint32Array($.buffer);t._copyTile(R,r,n,$,A,O,-C,-L,0),t._copyTile(S,r,n,$,A,O,-C,-L,3)?(t._copyTile(S,r,n,$,A,O,-C,-L,2),E=1):(t._copyTile(S,r,n,$,A,O,-C,-L,0),E=0),S=$,z=new Uint32Array(S.buffer)}var H=4*A;if(k<=256&&0==s){H=Math.ceil(l*A/8);for($=new Uint8Array(H*O),U=0;U<O;U++){_=U*H;var X=U*A;if(8==l)for(M=0;M<A;M++)$[_+M]=m[z[X+M]];else if(4==l)for(M=0;M<A;M++)$[_+(M>>1)]|=m[z[X+M]]<<4-4*(1&M);else if(2==l)for(M=0;M<A;M++)$[_+(M>>2)]|=m[z[X+M]]<<6-2*(3&M);else if(1==l)for(M=0;M<A;M++)$[_+(M>>3)]|=m[z[X+M]]<<7-1*(7&M)}S=$,o=3,h=1}else if(0==p&&1==e.length){$=new Uint8Array(A*O*3);var Y=A*O;for(_=0;_<Y;_++){var W=3*_,G=4*_;$[W]=S[G],$[W+1]=S[G+1],$[W+2]=S[G+2]}S=$,o=2,h=3,H=3*A}x.push({rect:{x:C,y:L,width:A,height:O},img:S,bpl:H,bpp:h,blend:E,dispose:y?1:0})}return{ctype:o,depth:l,plte:g,gotAlpha:p,frames:x}},t.encode._filterZero=function(r,n,i,a,s){for(var o=[],l=0;l<5;l++)if(!(n*a>5e5)||2!=l&&3!=l&&4!=l){for(var h=0;h<n;h++)t.encode._filterLine(s,r,h,a,i,l);if(o.push(e.deflate(s)),1==i)break}for(var c,d=1e9,f=0;f<o.length;f++)o[f].length<d&&(c=f,d=o[f].length);return o[c]},t.encode._filterLine=function(e,r,n,i,a,s){var o=n*i,l=o+n,h=t.decode._paeth;if(e[l]=s,l++,0==s)for(var c=0;c<i;c++)e[l+c]=r[o+c];else if(1==s){for(c=0;c<a;c++)e[l+c]=r[o+c];for(c=a;c<i;c++)e[l+c]=r[o+c]-r[o+c-a]+256&255}else if(0==n){for(c=0;c<a;c++)e[l+c]=r[o+c];if(2==s)for(c=a;c<i;c++)e[l+c]=r[o+c];if(3==s)for(c=a;c<i;c++)e[l+c]=r[o+c]-(r[o+c-a]>>1)+256&255;if(4==s)for(c=a;c<i;c++)e[l+c]=r[o+c]-h(r[o+c-a],0,0)+256&255}else{if(2==s)for(c=0;c<i;c++)e[l+c]=r[o+c]+256-r[o+c-i]&255;if(3==s){for(c=0;c<a;c++)e[l+c]=r[o+c]+256-(r[o+c-i]>>1)&255;for(c=a;c<i;c++)e[l+c]=r[o+c]+256-(r[o+c-i]+r[o+c-a]>>1)&255}if(4==s){for(c=0;c<a;c++)e[l+c]=r[o+c]+256-h(0,r[o+c-i],0)&255;for(c=a;c<i;c++)e[l+c]=r[o+c]+256-h(r[o+c-a],r[o+c-i],r[o+c-a-i])&255}}},t.crc={table:function(){for(var t=new Uint32Array(256),e=0;e<256;e++){for(var r=e,n=0;n<8;n++)1&r?r=3988292384^r>>>1:r>>>=1;t[e]=r}return t}(),update:function(e,r,n,i){for(var a=0;a<i;a++)e=t.crc.table[255&(e^r[n+a])]^e>>>8;return e},crc:function(e,r,n){return 4294967295^t.crc.update(4294967295,e,r,n)}},t.quantize=function(e,r,n){for(var i=[],a=0,s=0;s<e.length;s++)i.push(t.encode.alphaMul(new Uint8Array(e[s]),n)),a+=e[s].byteLength;var o=new Uint8Array(a),l=new Uint32Array(o.buffer),h=0;for(s=0;s<i.length;s++){for(var c=i[s],d=c.length,f=0;f<d;f++)o[h+f]=c[f];h+=d}var u={i0:0,i1:o.length,bst:null,est:null,tdst:0,left:null,right:null};u.bst=t.quantize.stats(o,u.i0,u.i1),u.est=t.quantize.estats(u.bst);for(var _=[u];_.length<r;){var p=0,m=0;for(s=0;s<_.length;s++)_[s].est.L>p&&(p=_[s].est.L,m=s);if(p<.001)break;var g=_[m],v=t.quantize.splitPixels(o,l,g.i0,g.i1,g.est.e,g.est.eMq255),b={i0:g.i0,i1:v,bst:null,est:null,tdst:0,left:null,right:null};b.bst=t.quantize.stats(o,b.i0,b.i1),b.est=t.quantize.estats(b.bst);var w={i0:v,i1:g.i1,bst:null,est:null,tdst:0,left:null,right:null};w.bst={R:[],m:[],N:g.bst.N-b.bst.N};for(s=0;s<16;s++)w.bst.R[s]=g.bst.R[s]-b.bst.R[s];for(s=0;s<4;s++)w.bst.m[s]=g.bst.m[s]-b.bst.m[s];w.est=t.quantize.estats(w.bst),g.left=b,g.right=w,_[m]=b,_.push(w)}_.sort(function(t,e){return e.bst.N-t.bst.N});for(var y=0;y<i.length;y++){var k=t.quantize.planeDst,x=new Uint8Array(i[y].buffer),S=new Uint32Array(i[y].buffer),z=x.length;for(s=0;s<z;s+=4){for(var C=x[s]*(1/255),L=x[s+1]*(1/255),A=x[s+2]*(1/255),O=x[s+3]*(1/255),E=u;E.left;)E=k(E.est,C,L,A,O)<=0?E.left:E.right;S[s>>2]=E.est.rgba}i[y]=S.buffer}return{bufs:i,plte:_}},t.quantize.getNearest=function(e,r,n,i,a){if(null==e.left)return e.tdst=t.quantize.dist(e.est.q,r,n,i,a),e;var s=t.quantize.planeDst(e.est,r,n,i,a),o=e.left,l=e.right;s>0&&(o=e.right,l=e.left);var h=t.quantize.getNearest(o,r,n,i,a);if(h.tdst<=s*s)return h;var c=t.quantize.getNearest(l,r,n,i,a);return c.tdst<h.tdst?c:h},t.quantize.planeDst=function(t,e,r,n,i){var a=t.e;return a[0]*e+a[1]*r+a[2]*n+a[3]*i-t.eMq},t.quantize.dist=function(t,e,r,n,i){var a=e-t[0],s=r-t[1],o=n-t[2],l=i-t[3];return a*a+s*s+o*o+l*l},t.quantize.splitPixels=function(e,r,n,i,a,s){var o=t.quantize.vecDot;i-=4;for(;n<i;){for(;o(e,n,a)<=s;)n+=4;for(;o(e,i,a)>s;)i-=4;if(n>=i)break;var l=r[n>>2];r[n>>2]=r[i>>2],r[i>>2]=l,n+=4,i-=4}for(;o(e,n,a)>s;)n-=4;return n+4},t.quantize.vecDot=function(t,e,r){return t[e]*r[0]+t[e+1]*r[1]+t[e+2]*r[2]+t[e+3]*r[3]},t.quantize.stats=function(t,e,r){for(var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=[0,0,0,0],a=r-e>>2,s=e;s<r;s+=4){var o=t[s]*(1/255),l=t[s+1]*(1/255),h=t[s+2]*(1/255),c=t[s+3]*(1/255);i[0]+=o,i[1]+=l,i[2]+=h,i[3]+=c,n[0]+=o*o,n[1]+=o*l,n[2]+=o*h,n[3]+=o*c,n[5]+=l*l,n[6]+=l*h,n[7]+=l*c,n[10]+=h*h,n[11]+=h*c,n[15]+=c*c}return n[4]=n[1],n[8]=n[2],n[12]=n[3],n[9]=n[6],n[13]=n[7],n[14]=n[11],{R:n,m:i,N:a}},t.quantize.estats=function(e){var r=e.R,n=e.m,i=e.N,a=n[0],s=n[1],o=n[2],l=n[3],h=0==i?0:1/i,c=[r[0]-a*a*h,r[1]-a*s*h,r[2]-a*o*h,r[3]-a*l*h,r[4]-s*a*h,r[5]-s*s*h,r[6]-s*o*h,r[7]-s*l*h,r[8]-o*a*h,r[9]-o*s*h,r[10]-o*o*h,r[11]-o*l*h,r[12]-l*a*h,r[13]-l*s*h,r[14]-l*o*h,r[15]-l*l*h],d=c,f=t.M4,u=[.5,.5,.5,.5],_=0,p=0;if(0!=i)for(var m=0;m<10&&(u=f.multVec(d,u),p=Math.sqrt(f.dot(u,u)),u=f.sml(1/p,u),!(Math.abs(p-_)<1e-9));m++)_=p;var g=[a*h,s*h,o*h,l*h],v=f.dot(f.sml(255,g),u),b=g[3]<.001?0:1/g[3];return{Cov:c,q:g,e:u,L:_,eMq255:v,eMq:f.dot(u,g),rgba:(Math.round(255*g[3])<<24|Math.round(255*g[2]*b)<<16|Math.round(255*g[1]*b)<<8|Math.round(255*g[0]*b)<<0)>>>0}},t.M4={multVec:function(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*e[3],t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*e[3],t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*e[3]]},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},sml:function(t,e){return[t*e[0],t*e[1],t*e[2],t*e[3]]}},t.encode.alphaMul=function(t,e){for(var r=new Uint8Array(t.length),n=t.length>>2,i=0;i<n;i++){var a=i<<2,s=t[a+3];e&&(s=s<128?0:255);var o=s*(1/255);r[a+0]=t[a+0]*o,r[a+1]=t[a+1]*o,r[a+2]=t[a+2]*o,r[a+3]=s}return r}}(e,r(13))}()}).call(this,r(12))},function(t,e){var r,n,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(t){r=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var l,h=[],c=!1,d=-1;function f(){c&&l&&(c=!1,l.length?h=l.concat(h):d=-1,h.length&&u())}function u(){if(!c){var t=o(f);c=!0;for(var e=h.length;e;){for(l=h,h=[];++d<e;)l&&l[d].run();d=-1,e=h.length}l=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function _(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new _(t,e)),1!==h.length||c||o(u)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,r){"use strict";var n={};(0,r(1).assign)(n,r(14),r(17),r(9)),t.exports=n},function(t,e,r){"use strict";var n=r(15),i=r(1),a=r(7),s=r(4),o=r(8),l=Object.prototype.toString,h=0,c=-1,d=0,f=8;function u(t){if(!(this instanceof u))return new u(t);this.options=i.assign({level:c,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==h)throw new Error(s[r]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var _;if(_="string"==typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(r=n.deflateSetDictionary(this.strm,_))!==h)throw new Error(s[r]);this._dict_set=!0}}function _(t,e){var r=new u(e);if(r.push(t,!0),r.err)throw r.msg||s[r.err];return r.result}u.prototype.push=function(t,e){var r,s,o=this.strm,c=this.options.chunkSize;if(this.ended)return!1;s=e===~~e?e:!0===e?4:0,"string"==typeof t?o.input=a.string2buf(t):"[object ArrayBuffer]"===l.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new i.Buf8(c),o.next_out=0,o.avail_out=c),1!==(r=n.deflate(o,s))&&r!==h)return this.onEnd(r),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(o.output,o.next_out))):this.onData(i.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==r);return 4===s?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===h):2!==s||(this.onEnd(h),o.avail_out=0,!0)},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){t===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=u,e.deflate=_,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,_(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,_(t,e)}},function(t,e,r){"use strict";var n,i=r(1),a=r(16),s=r(5),o=r(6),l=r(4),h=0,c=1,d=3,f=4,u=5,_=0,p=1,m=-2,g=-3,v=-5,b=-1,w=1,y=2,k=3,x=4,S=0,z=2,C=8,L=9,A=15,O=8,E=286,I=30,q=19,j=2*E+1,T=15,R=3,P=258,D=P+R+1,N=32,F=42,B=69,U=73,M=91,Z=103,$=113,H=666,X=1,Y=2,W=3,G=4,K=3;function V(t,e){return t.msg=l[e],e}function J(t){return(t<<1)-(t>4?9:0)}function Q(t){for(var e=t.length;--e>=0;)t[e]=0}function tt(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(i.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function et(t,e){a._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function rt(t,e){t.pending_buf[t.pending++]=e}function nt(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function it(t,e){var r,n,i=t.max_chain_length,a=t.strstart,s=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-D?t.strstart-(t.w_size-D):0,h=t.window,c=t.w_mask,d=t.prev,f=t.strstart+P,u=h[a+s-1],_=h[a+s];t.prev_length>=t.good_match&&(i>>=2),o>t.lookahead&&(o=t.lookahead);do{if(h[(r=e)+s]===_&&h[r+s-1]===u&&h[r]===h[a]&&h[++r]===h[a+1]){a+=2,r++;do{}while(h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&h[++a]===h[++r]&&a<f);if(n=P-(f-a),a=f-P,n>s){if(t.match_start=e,s=n,n>=o)break;u=h[a+s-1],_=h[a+s]}}}while((e=d[e&c])>l&&0!=--i);return s<=t.lookahead?s:t.lookahead}function at(t){var e,r,n,a,l,h,c,d,f,u,_=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=_+(_-D)){i.arraySet(t.window,t.window,_,_,0),t.match_start-=_,t.strstart-=_,t.block_start-=_,e=r=t.hash_size;do{n=t.head[--e],t.head[e]=n>=_?n-_:0}while(--r);e=r=_;do{n=t.prev[--e],t.prev[e]=n>=_?n-_:0}while(--r);a+=_}if(0===t.strm.avail_in)break;if(h=t.strm,c=t.window,d=t.strstart+t.lookahead,f=a,u=void 0,(u=h.avail_in)>f&&(u=f),r=0===u?0:(h.avail_in-=u,i.arraySet(c,h.input,h.next_in,u,d),1===h.state.wrap?h.adler=s(h.adler,c,u,d):2===h.state.wrap&&(h.adler=o(h.adler,c,u,d)),h.next_in+=u,h.total_in+=u,u),t.lookahead+=r,t.lookahead+t.insert>=R)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+R-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<R)););}while(t.lookahead<D&&0!==t.strm.avail_in)}function st(t,e){for(var r,n;;){if(t.lookahead<D){if(at(t),t.lookahead<D&&e===h)return X;if(0===t.lookahead)break}if(r=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-D&&(t.match_length=it(t,r)),t.match_length>=R)if(n=a._tr_tally(t,t.strstart-t.match_start,t.match_length-R),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=R){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(et(t,!1),0===t.strm.avail_out))return X}return t.insert=t.strstart<R-1?t.strstart:R-1,e===f?(et(t,!0),0===t.strm.avail_out?W:G):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?X:Y}function ot(t,e){for(var r,n,i;;){if(t.lookahead<D){if(at(t),t.lookahead<D&&e===h)return X;if(0===t.lookahead)break}if(r=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=R-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-D&&(t.match_length=it(t,r),t.match_length<=5&&(t.strategy===w||t.match_length===R&&t.strstart-t.match_start>4096)&&(t.match_length=R-1)),t.prev_length>=R&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-R,n=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-R),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=R-1,t.strstart++,n&&(et(t,!1),0===t.strm.avail_out))return X}else if(t.match_available){if((n=a._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return X}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<R-1?t.strstart:R-1,e===f?(et(t,!0),0===t.strm.avail_out?W:G):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?X:Y}function lt(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}function ht(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*j),this.dyn_dtree=new i.Buf16(2*(2*I+1)),this.bl_tree=new i.Buf16(2*(2*q+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(T+1),this.heap=new i.Buf16(2*E+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*E+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ct(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=z,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?F:$,t.adler=2===e.wrap?0:1,e.last_flush=h,a._tr_init(e),_):V(t,m)}function dt(t){var e,r=ct(t);return r===_&&((e=t.state).window_size=2*e.w_size,Q(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=R-1,e.match_available=0,e.ins_h=0),r}function ft(t,e,r,n,a,s){if(!t)return m;var o=1;if(e===b&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),a<1||a>L||r!==C||n<8||n>15||e<0||e>9||s<0||s>x)return V(t,m);8===n&&(n=9);var l=new ht;return t.state=l,l.strm=t,l.wrap=o,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+R-1)/R),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=s,l.method=r,dt(t)}n=[new lt(0,0,0,0,function(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),0===t.lookahead&&e===h)return X;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,et(t,!1),0===t.strm.avail_out))return X;if(t.strstart-t.block_start>=t.w_size-D&&(et(t,!1),0===t.strm.avail_out))return X}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?W:G):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),X)}),new lt(4,4,8,4,st),new lt(4,5,16,8,st),new lt(4,6,32,32,st),new lt(4,4,16,16,ot),new lt(8,16,32,32,ot),new lt(8,16,128,128,ot),new lt(8,32,128,256,ot),new lt(32,128,258,1024,ot),new lt(32,258,258,4096,ot)],e.deflateInit=function(t,e){return ft(t,e,C,A,O,S)},e.deflateInit2=ft,e.deflateReset=dt,e.deflateResetKeep=ct,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?m:(t.state.gzhead=e,_):m},e.deflate=function(t,e){var r,i,s,l;if(!t||!t.state||e>u||e<0)return t?V(t,m):m;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||i.status===H&&e!==f)return V(t,0===t.avail_out?v:m);if(i.strm=t,r=i.last_flush,i.last_flush=e,i.status===F)if(2===i.wrap)t.adler=0,rt(i,31),rt(i,139),rt(i,8),i.gzhead?(rt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),rt(i,255&i.gzhead.time),rt(i,i.gzhead.time>>8&255),rt(i,i.gzhead.time>>16&255),rt(i,i.gzhead.time>>24&255),rt(i,9===i.level?2:i.strategy>=y||i.level<2?4:0),rt(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(rt(i,255&i.gzhead.extra.length),rt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=o(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=B):(rt(i,0),rt(i,0),rt(i,0),rt(i,0),rt(i,0),rt(i,9===i.level?2:i.strategy>=y||i.level<2?4:0),rt(i,K),i.status=$);else{var g=C+(i.w_bits-8<<4)<<8;g|=(i.strategy>=y||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(g|=N),g+=31-g%31,i.status=$,nt(i,g),0!==i.strstart&&(nt(i,t.adler>>>16),nt(i,65535&t.adler)),t.adler=1}if(i.status===B)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),tt(t),s=i.pending,i.pending!==i.pending_buf_size));)rt(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=U)}else i.status=U;if(i.status===U)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),tt(t),s=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,rt(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),0===l&&(i.gzindex=0,i.status=M)}else i.status=M;if(i.status===M)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),tt(t),s=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,rt(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),0===l&&(i.status=Z)}else i.status=Z;if(i.status===Z&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&tt(t),i.pending+2<=i.pending_buf_size&&(rt(i,255&t.adler),rt(i,t.adler>>8&255),t.adler=0,i.status=$)):i.status=$),0!==i.pending){if(tt(t),0===t.avail_out)return i.last_flush=-1,_}else if(0===t.avail_in&&J(e)<=J(r)&&e!==f)return V(t,v);if(i.status===H&&0!==t.avail_in)return V(t,v);if(0!==t.avail_in||0!==i.lookahead||e!==h&&i.status!==H){var b=i.strategy===y?function(t,e){for(var r;;){if(0===t.lookahead&&(at(t),0===t.lookahead)){if(e===h)return X;break}if(t.match_length=0,r=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(et(t,!1),0===t.strm.avail_out))return X}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?W:G):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?X:Y}(i,e):i.strategy===k?function(t,e){for(var r,n,i,s,o=t.window;;){if(t.lookahead<=P){if(at(t),t.lookahead<=P&&e===h)return X;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=R&&t.strstart>0&&(n=o[i=t.strstart-1])===o[++i]&&n===o[++i]&&n===o[++i]){s=t.strstart+P;do{}while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<s);t.match_length=P-(s-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=R?(r=a._tr_tally(t,1,t.match_length-R),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(et(t,!1),0===t.strm.avail_out))return X}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?W:G):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?X:Y}(i,e):n[i.level].func(i,e);if(b!==W&&b!==G||(i.status=H),b===X||b===W)return 0===t.avail_out&&(i.last_flush=-1),_;if(b===Y&&(e===c?a._tr_align(i):e!==u&&(a._tr_stored_block(i,0,0,!1),e===d&&(Q(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),tt(t),0===t.avail_out))return i.last_flush=-1,_}return e!==f?_:i.wrap<=0?p:(2===i.wrap?(rt(i,255&t.adler),rt(i,t.adler>>8&255),rt(i,t.adler>>16&255),rt(i,t.adler>>24&255),rt(i,255&t.total_in),rt(i,t.total_in>>8&255),rt(i,t.total_in>>16&255),rt(i,t.total_in>>24&255)):(nt(i,t.adler>>>16),nt(i,65535&t.adler)),tt(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?_:p)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==F&&e!==B&&e!==U&&e!==M&&e!==Z&&e!==$&&e!==H?V(t,m):(t.state=null,e===$?V(t,g):_):m},e.deflateSetDictionary=function(t,e){var r,n,a,o,l,h,c,d,f=e.length;if(!t||!t.state)return m;if(2===(o=(r=t.state).wrap)||1===o&&r.status!==F||r.lookahead)return m;for(1===o&&(t.adler=s(t.adler,e,f,0)),r.wrap=0,f>=r.w_size&&(0===o&&(Q(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new i.Buf8(r.w_size),i.arraySet(d,e,f-r.w_size,r.w_size,0),e=d,f=r.w_size),l=t.avail_in,h=t.next_in,c=t.input,t.avail_in=f,t.next_in=0,t.input=e,at(r);r.lookahead>=R;){n=r.strstart,a=r.lookahead-(R-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+R-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--a);r.strstart=n,r.lookahead=R-1,at(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=R-1,r.match_available=0,t.next_in=h,t.input=c,t.avail_in=l,r.wrap=o,_},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,r){"use strict";var n=r(1),i=4,a=0,s=1,o=2;function l(t){for(var e=t.length;--e>=0;)t[e]=0}var h=0,c=1,d=2,f=29,u=256,_=u+1+f,p=30,m=19,g=2*_+1,v=15,b=16,w=7,y=256,k=16,x=17,S=18,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=new Array(2*(_+2));l(O);var E=new Array(2*p);l(E);var I=new Array(512);l(I);var q=new Array(256);l(q);var j=new Array(f);l(j);var T,R,P,D=new Array(p);function N(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}function F(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function B(t){return t<256?I[t]:I[256+(t>>>7)]}function U(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function M(t,e,r){t.bi_valid>b-r?(t.bi_buf|=e<<t.bi_valid&65535,U(t,t.bi_buf),t.bi_buf=e>>b-t.bi_valid,t.bi_valid+=r-b):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function Z(t,e,r){M(t,r[2*e],r[2*e+1])}function $(t,e){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1}function H(t,e,r){var n,i,a=new Array(v+1),s=0;for(n=1;n<=v;n++)a[n]=s=s+r[n-1]<<1;for(i=0;i<=e;i++){var o=t[2*i+1];0!==o&&(t[2*i]=$(a[o]++,o))}}function X(t){var e;for(e=0;e<_;e++)t.dyn_ltree[2*e]=0;for(e=0;e<p;e++)t.dyn_dtree[2*e]=0;for(e=0;e<m;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*y]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function Y(t){t.bi_valid>8?U(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function W(t,e,r,n){var i=2*e,a=2*r;return t[i]<t[a]||t[i]===t[a]&&n[e]<=n[r]}function G(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&W(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!W(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n}function K(t,e,r){var n,i,a,s,o=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],i=t.pending_buf[t.l_buf+o],o++,0===n?Z(t,i,e):(Z(t,(a=q[i])+u+1,e),0!==(s=z[a])&&M(t,i-=j[a],s),Z(t,a=B(--n),r),0!==(s=C[a])&&M(t,n-=D[a],s))}while(o<t.last_lit);Z(t,y,e)}function V(t,e){var r,n,i,a=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,l=e.stat_desc.elems,h=-1;for(t.heap_len=0,t.heap_max=g,r=0;r<l;r++)0!==a[2*r]?(t.heap[++t.heap_len]=h=r,t.depth[r]=0):a[2*r+1]=0;for(;t.heap_len<2;)a[2*(i=t.heap[++t.heap_len]=h<2?++h:0)]=1,t.depth[i]=0,t.opt_len--,o&&(t.static_len-=s[2*i+1]);for(e.max_code=h,r=t.heap_len>>1;r>=1;r--)G(t,a,r);i=l;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],G(t,a,1),n=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=n,a[2*i]=a[2*r]+a[2*n],t.depth[i]=(t.depth[r]>=t.depth[n]?t.depth[r]:t.depth[n])+1,a[2*r+1]=a[2*n+1]=i,t.heap[1]=i++,G(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var r,n,i,a,s,o,l=e.dyn_tree,h=e.max_code,c=e.stat_desc.static_tree,d=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,u=e.stat_desc.extra_base,_=e.stat_desc.max_length,p=0;for(a=0;a<=v;a++)t.bl_count[a]=0;for(l[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<g;r++)(a=l[2*l[2*(n=t.heap[r])+1]+1]+1)>_&&(a=_,p++),l[2*n+1]=a,n>h||(t.bl_count[a]++,s=0,n>=u&&(s=f[n-u]),o=l[2*n],t.opt_len+=o*(a+s),d&&(t.static_len+=o*(c[2*n+1]+s)));if(0!==p){do{for(a=_-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[_]--,p-=2}while(p>0);for(a=_;0!==a;a--)for(n=t.bl_count[a];0!==n;)(i=t.heap[--r])>h||(l[2*i+1]!==a&&(t.opt_len+=(a-l[2*i+1])*l[2*i],l[2*i+1]=a),n--)}}(t,e),H(a,h,t.bl_count)}function J(t,e,r){var n,i,a=-1,s=e[1],o=0,l=7,h=4;for(0===s&&(l=138,h=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=e[2*(n+1)+1],++o<l&&i===s||(o<h?t.bl_tree[2*i]+=o:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[2*k]++):o<=10?t.bl_tree[2*x]++:t.bl_tree[2*S]++,o=0,a=i,0===s?(l=138,h=3):i===s?(l=6,h=3):(l=7,h=4))}function Q(t,e,r){var n,i,a=-1,s=e[1],o=0,l=7,h=4;for(0===s&&(l=138,h=3),n=0;n<=r;n++)if(i=s,s=e[2*(n+1)+1],!(++o<l&&i===s)){if(o<h)do{Z(t,i,t.bl_tree)}while(0!=--o);else 0!==i?(i!==a&&(Z(t,i,t.bl_tree),o--),Z(t,k,t.bl_tree),M(t,o-3,2)):o<=10?(Z(t,x,t.bl_tree),M(t,o-3,3)):(Z(t,S,t.bl_tree),M(t,o-11,7));o=0,a=i,0===s?(l=138,h=3):i===s?(l=6,h=3):(l=7,h=4)}}l(D);var tt=!1;function et(t,e,r,i){M(t,(h<<1)+(i?1:0),3),function(t,e,r,i){Y(t),i&&(U(t,r),U(t,~r)),n.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}(t,e,r,!0)}e._tr_init=function(t){tt||(function(){var t,e,r,n,i,a=new Array(v+1);for(r=0,n=0;n<f-1;n++)for(j[n]=r,t=0;t<1<<z[n];t++)q[r++]=n;for(q[r-1]=n,i=0,n=0;n<16;n++)for(D[n]=i,t=0;t<1<<C[n];t++)I[i++]=n;for(i>>=7;n<p;n++)for(D[n]=i<<7,t=0;t<1<<C[n]-7;t++)I[256+i++]=n;for(e=0;e<=v;e++)a[e]=0;for(t=0;t<=143;)O[2*t+1]=8,t++,a[8]++;for(;t<=255;)O[2*t+1]=9,t++,a[9]++;for(;t<=279;)O[2*t+1]=7,t++,a[7]++;for(;t<=287;)O[2*t+1]=8,t++,a[8]++;for(H(O,_+1,a),t=0;t<p;t++)E[2*t+1]=5,E[2*t]=$(t,5);T=new N(O,z,u+1,_,v),R=new N(E,C,0,p,v),P=new N(new Array(0),L,0,m,w)}(),tt=!0),t.l_desc=new F(t.dyn_ltree,T),t.d_desc=new F(t.dyn_dtree,R),t.bl_desc=new F(t.bl_tree,P),t.bi_buf=0,t.bi_valid=0,X(t)},e._tr_stored_block=et,e._tr_flush_block=function(t,e,r,n){var l,h,f=0;t.level>0?(t.strm.data_type===o&&(t.strm.data_type=function(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return a;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return s;for(e=32;e<u;e++)if(0!==t.dyn_ltree[2*e])return s;return a}(t)),V(t,t.l_desc),V(t,t.d_desc),f=function(t){var e;for(J(t,t.dyn_ltree,t.l_desc.max_code),J(t,t.dyn_dtree,t.d_desc.max_code),V(t,t.bl_desc),e=m-1;e>=3&&0===t.bl_tree[2*A[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),l=t.opt_len+3+7>>>3,(h=t.static_len+3+7>>>3)<=l&&(l=h)):l=h=r+5,r+4<=l&&-1!==e?et(t,e,r,n):t.strategy===i||h===l?(M(t,(c<<1)+(n?1:0),3),K(t,O,E)):(M(t,(d<<1)+(n?1:0),3),function(t,e,r,n){var i;for(M(t,e-257,5),M(t,r-1,5),M(t,n-4,4),i=0;i<n;i++)M(t,t.bl_tree[2*A[i]+1],3);Q(t,t.dyn_ltree,e-1),Q(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,f+1),K(t,t.dyn_ltree,t.dyn_dtree)),X(t),n&&Y(t)},e._tr_tally=function(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(q[r]+u+1)]++,t.dyn_dtree[2*B(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){M(t,c<<1,3),Z(t,y,O),function(t){16===t.bi_valid?(U(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,r){"use strict";var n=r(18),i=r(1),a=r(7),s=r(9),o=r(4),l=r(8),h=r(21),c=Object.prototype.toString;function d(t){if(!(this instanceof d))return new d(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,e.windowBits);if(r!==s.Z_OK)throw new Error(o[r]);if(this.header=new h,n.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=a.string2buf(e.dictionary):"[object ArrayBuffer]"===c.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=n.inflateSetDictionary(this.strm,e.dictionary))!==s.Z_OK))throw new Error(o[r])}function f(t,e){var r=new d(e);if(r.push(t,!0),r.err)throw r.msg||o[r.err];return r.result}d.prototype.push=function(t,e){var r,o,l,h,d,f=this.strm,u=this.options.chunkSize,_=this.options.dictionary,p=!1;if(this.ended)return!1;o=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof t?f.input=a.binstring2buf(t):"[object ArrayBuffer]"===c.call(t)?f.input=new Uint8Array(t):f.input=t,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(u),f.next_out=0,f.avail_out=u),(r=n.inflate(f,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&_&&(r=n.inflateSetDictionary(this.strm,_)),r===s.Z_BUF_ERROR&&!0===p&&(r=s.Z_OK,p=!1),r!==s.Z_STREAM_END&&r!==s.Z_OK)return this.onEnd(r),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&r!==s.Z_STREAM_END&&(0!==f.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(f.output,f.next_out),h=f.next_out-l,d=a.buf2string(f.output,l),f.next_out=h,f.avail_out=u-h,h&&i.arraySet(f.output,f.output,l,h,0),this.onData(d)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(p=!0)}while((f.avail_in>0||0===f.avail_out)&&r!==s.Z_STREAM_END);return r===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),f.avail_out=0,!0)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=d,e.inflate=f,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},e.ungzip=f},function(t,e,r){"use strict";var n=r(1),i=r(5),a=r(6),s=r(19),o=r(20),l=0,h=1,c=2,d=4,f=5,u=6,_=0,p=1,m=2,g=-2,v=-3,b=-4,w=-5,y=8,k=1,x=2,S=3,z=4,C=5,L=6,A=7,O=8,E=9,I=10,q=11,j=12,T=13,R=14,P=15,D=16,N=17,F=18,B=19,U=20,M=21,Z=22,$=23,H=24,X=25,Y=26,W=27,G=28,K=29,V=30,J=31,Q=32,tt=852,et=592,rt=15;function nt(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function it(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function at(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=k,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(tt),e.distcode=e.distdyn=new n.Buf32(et),e.sane=1,e.back=-1,_):g}function st(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,at(t)):g}function ot(t,e){var r,n;return t&&t.state?(n=t.state,e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?g:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,st(t))):g}function lt(t,e){var r,n;return t?(n=new it,t.state=n,n.window=null,(r=ot(t,e))!==_&&(t.state=null),r):g}var ht,ct,dt=!0;function ft(t){if(dt){var e;for(ht=new n.Buf32(512),ct=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(h,t.lens,0,288,ht,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(c,t.lens,0,32,ct,0,t.work,{bits:5}),dt=!1}t.lencode=ht,t.lenbits=9,t.distcode=ct,t.distbits=5}function ut(t,e,r,i){var a,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new n.Buf8(s.wsize)),i>=s.wsize?(n.arraySet(s.window,e,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((a=s.wsize-s.wnext)>i&&(a=i),n.arraySet(s.window,e,r-i,a,s.wnext),(i-=a)?(n.arraySet(s.window,e,r-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}e.inflateReset=st,e.inflateReset2=ot,e.inflateResetKeep=at,e.inflateInit=function(t){return lt(t,rt)},e.inflateInit2=lt,e.inflate=function(t,e){var r,tt,et,rt,it,at,st,ot,lt,ht,ct,dt,_t,pt,mt,gt,vt,bt,wt,yt,kt,xt,St,zt,Ct=0,Lt=new n.Buf8(4),At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return g;(r=t.state).mode===j&&(r.mode=T),it=t.next_out,et=t.output,st=t.avail_out,rt=t.next_in,tt=t.input,at=t.avail_in,ot=r.hold,lt=r.bits,ht=at,ct=st,xt=_;t:for(;;)switch(r.mode){case k:if(0===r.wrap){r.mode=T;break}for(;lt<16;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if(2&r.wrap&&35615===ot){r.check=0,Lt[0]=255&ot,Lt[1]=ot>>>8&255,r.check=a(r.check,Lt,2,0),ot=0,lt=0,r.mode=x;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&ot)<<8)+(ot>>8))%31){t.msg="incorrect header check",r.mode=V;break}if((15&ot)!==y){t.msg="unknown compression method",r.mode=V;break}if(lt-=4,kt=8+(15&(ot>>>=4)),0===r.wbits)r.wbits=kt;else if(kt>r.wbits){t.msg="invalid window size",r.mode=V;break}r.dmax=1<<kt,t.adler=r.check=1,r.mode=512&ot?I:j,ot=0,lt=0;break;case x:for(;lt<16;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if(r.flags=ot,(255&r.flags)!==y){t.msg="unknown compression method",r.mode=V;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=V;break}r.head&&(r.head.text=ot>>8&1),512&r.flags&&(Lt[0]=255&ot,Lt[1]=ot>>>8&255,r.check=a(r.check,Lt,2,0)),ot=0,lt=0,r.mode=S;case S:for(;lt<32;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}r.head&&(r.head.time=ot),512&r.flags&&(Lt[0]=255&ot,Lt[1]=ot>>>8&255,Lt[2]=ot>>>16&255,Lt[3]=ot>>>24&255,r.check=a(r.check,Lt,4,0)),ot=0,lt=0,r.mode=z;case z:for(;lt<16;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}r.head&&(r.head.xflags=255&ot,r.head.os=ot>>8),512&r.flags&&(Lt[0]=255&ot,Lt[1]=ot>>>8&255,r.check=a(r.check,Lt,2,0)),ot=0,lt=0,r.mode=C;case C:if(1024&r.flags){for(;lt<16;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}r.length=ot,r.head&&(r.head.extra_len=ot),512&r.flags&&(Lt[0]=255&ot,Lt[1]=ot>>>8&255,r.check=a(r.check,Lt,2,0)),ot=0,lt=0}else r.head&&(r.head.extra=null);r.mode=L;case L:if(1024&r.flags&&((dt=r.length)>at&&(dt=at),dt&&(r.head&&(kt=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,tt,rt,dt,kt)),512&r.flags&&(r.check=a(r.check,tt,dt,rt)),at-=dt,rt+=dt,r.length-=dt),r.length))break t;r.length=0,r.mode=A;case A:if(2048&r.flags){if(0===at)break t;dt=0;do{kt=tt[rt+dt++],r.head&&kt&&r.length<65536&&(r.head.name+=String.fromCharCode(kt))}while(kt&&dt<at);if(512&r.flags&&(r.check=a(r.check,tt,dt,rt)),at-=dt,rt+=dt,kt)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=O;case O:if(4096&r.flags){if(0===at)break t;dt=0;do{kt=tt[rt+dt++],r.head&&kt&&r.length<65536&&(r.head.comment+=String.fromCharCode(kt))}while(kt&&dt<at);if(512&r.flags&&(r.check=a(r.check,tt,dt,rt)),at-=dt,rt+=dt,kt)break t}else r.head&&(r.head.comment=null);r.mode=E;case E:if(512&r.flags){for(;lt<16;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if(ot!==(65535&r.check)){t.msg="header crc mismatch",r.mode=V;break}ot=0,lt=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=j;break;case I:for(;lt<32;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}t.adler=r.check=nt(ot),ot=0,lt=0,r.mode=q;case q:if(0===r.havedict)return t.next_out=it,t.avail_out=st,t.next_in=rt,t.avail_in=at,r.hold=ot,r.bits=lt,m;t.adler=r.check=1,r.mode=j;case j:if(e===f||e===u)break t;case T:if(r.last){ot>>>=7&lt,lt-=7&lt,r.mode=W;break}for(;lt<3;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}switch(r.last=1&ot,lt-=1,3&(ot>>>=1)){case 0:r.mode=R;break;case 1:if(ft(r),r.mode=U,e===u){ot>>>=2,lt-=2;break t}break;case 2:r.mode=N;break;case 3:t.msg="invalid block type",r.mode=V}ot>>>=2,lt-=2;break;case R:for(ot>>>=7&lt,lt-=7&lt;lt<32;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if((65535&ot)!=(ot>>>16^65535)){t.msg="invalid stored block lengths",r.mode=V;break}if(r.length=65535&ot,ot=0,lt=0,r.mode=P,e===u)break t;case P:r.mode=D;case D:if(dt=r.length){if(dt>at&&(dt=at),dt>st&&(dt=st),0===dt)break t;n.arraySet(et,tt,rt,dt,it),at-=dt,rt+=dt,st-=dt,it+=dt,r.length-=dt;break}r.mode=j;break;case N:for(;lt<14;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if(r.nlen=257+(31&ot),ot>>>=5,lt-=5,r.ndist=1+(31&ot),ot>>>=5,lt-=5,r.ncode=4+(15&ot),ot>>>=4,lt-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=V;break}r.have=0,r.mode=F;case F:for(;r.have<r.ncode;){for(;lt<3;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}r.lens[At[r.have++]]=7&ot,ot>>>=3,lt-=3}for(;r.have<19;)r.lens[At[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,St={bits:r.lenbits},xt=o(l,r.lens,0,19,r.lencode,0,r.work,St),r.lenbits=St.bits,xt){t.msg="invalid code lengths set",r.mode=V;break}r.have=0,r.mode=B;case B:for(;r.have<r.nlen+r.ndist;){for(;gt=(Ct=r.lencode[ot&(1<<r.lenbits)-1])>>>16&255,vt=65535&Ct,!((mt=Ct>>>24)<=lt);){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if(vt<16)ot>>>=mt,lt-=mt,r.lens[r.have++]=vt;else{if(16===vt){for(zt=mt+2;lt<zt;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if(ot>>>=mt,lt-=mt,0===r.have){t.msg="invalid bit length repeat",r.mode=V;break}kt=r.lens[r.have-1],dt=3+(3&ot),ot>>>=2,lt-=2}else if(17===vt){for(zt=mt+3;lt<zt;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}lt-=mt,kt=0,dt=3+(7&(ot>>>=mt)),ot>>>=3,lt-=3}else{for(zt=mt+7;lt<zt;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}lt-=mt,kt=0,dt=11+(127&(ot>>>=mt)),ot>>>=7,lt-=7}if(r.have+dt>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=V;break}for(;dt--;)r.lens[r.have++]=kt}}if(r.mode===V)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=V;break}if(r.lenbits=9,St={bits:r.lenbits},xt=o(h,r.lens,0,r.nlen,r.lencode,0,r.work,St),r.lenbits=St.bits,xt){t.msg="invalid literal/lengths set",r.mode=V;break}if(r.distbits=6,r.distcode=r.distdyn,St={bits:r.distbits},xt=o(c,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,St),r.distbits=St.bits,xt){t.msg="invalid distances set",r.mode=V;break}if(r.mode=U,e===u)break t;case U:r.mode=M;case M:if(at>=6&&st>=258){t.next_out=it,t.avail_out=st,t.next_in=rt,t.avail_in=at,r.hold=ot,r.bits=lt,s(t,ct),it=t.next_out,et=t.output,st=t.avail_out,rt=t.next_in,tt=t.input,at=t.avail_in,ot=r.hold,lt=r.bits,r.mode===j&&(r.back=-1);break}for(r.back=0;gt=(Ct=r.lencode[ot&(1<<r.lenbits)-1])>>>16&255,vt=65535&Ct,!((mt=Ct>>>24)<=lt);){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if(gt&&0==(240&gt)){for(bt=mt,wt=gt,yt=vt;gt=(Ct=r.lencode[yt+((ot&(1<<bt+wt)-1)>>bt)])>>>16&255,vt=65535&Ct,!(bt+(mt=Ct>>>24)<=lt);){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}ot>>>=bt,lt-=bt,r.back+=bt}if(ot>>>=mt,lt-=mt,r.back+=mt,r.length=vt,0===gt){r.mode=Y;break}if(32&gt){r.back=-1,r.mode=j;break}if(64&gt){t.msg="invalid literal/length code",r.mode=V;break}r.extra=15&gt,r.mode=Z;case Z:if(r.extra){for(zt=r.extra;lt<zt;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}r.length+=ot&(1<<r.extra)-1,ot>>>=r.extra,lt-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=$;case $:for(;gt=(Ct=r.distcode[ot&(1<<r.distbits)-1])>>>16&255,vt=65535&Ct,!((mt=Ct>>>24)<=lt);){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if(0==(240&gt)){for(bt=mt,wt=gt,yt=vt;gt=(Ct=r.distcode[yt+((ot&(1<<bt+wt)-1)>>bt)])>>>16&255,vt=65535&Ct,!(bt+(mt=Ct>>>24)<=lt);){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}ot>>>=bt,lt-=bt,r.back+=bt}if(ot>>>=mt,lt-=mt,r.back+=mt,64&gt){t.msg="invalid distance code",r.mode=V;break}r.offset=vt,r.extra=15&gt,r.mode=H;case H:if(r.extra){for(zt=r.extra;lt<zt;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}r.offset+=ot&(1<<r.extra)-1,ot>>>=r.extra,lt-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=V;break}r.mode=X;case X:if(0===st)break t;if(dt=ct-st,r.offset>dt){if((dt=r.offset-dt)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=V;break}dt>r.wnext?(dt-=r.wnext,_t=r.wsize-dt):_t=r.wnext-dt,dt>r.length&&(dt=r.length),pt=r.window}else pt=et,_t=it-r.offset,dt=r.length;dt>st&&(dt=st),st-=dt,r.length-=dt;do{et[it++]=pt[_t++]}while(--dt);0===r.length&&(r.mode=M);break;case Y:if(0===st)break t;et[it++]=r.length,st--,r.mode=M;break;case W:if(r.wrap){for(;lt<32;){if(0===at)break t;at--,ot|=tt[rt++]<<lt,lt+=8}if(ct-=st,t.total_out+=ct,r.total+=ct,ct&&(t.adler=r.check=r.flags?a(r.check,et,ct,it-ct):i(r.check,et,ct,it-ct)),ct=st,(r.flags?ot:nt(ot))!==r.check){t.msg="incorrect data check",r.mode=V;break}ot=0,lt=0}r.mode=G;case G:if(r.wrap&&r.flags){for(;lt<32;){if(0===at)break t;at--,ot+=tt[rt++]<<lt,lt+=8}if(ot!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=V;break}ot=0,lt=0}r.mode=K;case K:xt=p;break t;case V:xt=v;break t;case J:return b;case Q:default:return g}return t.next_out=it,t.avail_out=st,t.next_in=rt,t.avail_in=at,r.hold=ot,r.bits=lt,(r.wsize||ct!==t.avail_out&&r.mode<V&&(r.mode<W||e!==d))&&ut(t,t.output,t.next_out,ct-t.avail_out)?(r.mode=J,b):(ht-=t.avail_in,ct-=t.avail_out,t.total_in+=ht,t.total_out+=ct,r.total+=ct,r.wrap&&ct&&(t.adler=r.check=r.flags?a(r.check,et,ct,t.next_out-ct):i(r.check,et,ct,t.next_out-ct)),t.data_type=r.bits+(r.last?64:0)+(r.mode===j?128:0)+(r.mode===U||r.mode===P?256:0),(0===ht&&0===ct||e===d)&&xt===_&&(xt=w),xt)},e.inflateEnd=function(t){if(!t||!t.state)return g;var e=t.state;return e.window&&(e.window=null),t.state=null,_},e.inflateGetHeader=function(t,e){var r;return t&&t.state?0==(2&(r=t.state).wrap)?g:(r.head=e,e.done=!1,_):g},e.inflateSetDictionary=function(t,e){var r,n=e.length;return t&&t.state?0!==(r=t.state).wrap&&r.mode!==q?g:r.mode===q&&i(1,e,n,0)!==r.check?v:ut(t,e,n,n)?(r.mode=J,b):(r.havedict=1,_):g},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,r){"use strict";t.exports=function(t,e){var r,n,i,a,s,o,l,h,c,d,f,u,_,p,m,g,v,b,w,y,k,x,S,z,C;r=t.state,n=t.next_in,z=t.input,i=n+(t.avail_in-5),a=t.next_out,C=t.output,s=a-(e-t.avail_out),o=a+(t.avail_out-257),l=r.dmax,h=r.wsize,c=r.whave,d=r.wnext,f=r.window,u=r.hold,_=r.bits,p=r.lencode,m=r.distcode,g=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;t:do{_<15&&(u+=z[n++]<<_,_+=8,u+=z[n++]<<_,_+=8),b=p[u&g];e:for(;;){if(u>>>=w=b>>>24,_-=w,0===(w=b>>>16&255))C[a++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=p[(65535&b)+(u&(1<<w)-1)];continue e}if(32&w){r.mode=12;break t}t.msg="invalid literal/length code",r.mode=30;break t}y=65535&b,(w&=15)&&(_<w&&(u+=z[n++]<<_,_+=8),y+=u&(1<<w)-1,u>>>=w,_-=w),_<15&&(u+=z[n++]<<_,_+=8,u+=z[n++]<<_,_+=8),b=m[u&v];r:for(;;){if(u>>>=w=b>>>24,_-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=m[(65535&b)+(u&(1<<w)-1)];continue r}t.msg="invalid distance code",r.mode=30;break t}if(k=65535&b,_<(w&=15)&&(u+=z[n++]<<_,(_+=8)<w&&(u+=z[n++]<<_,_+=8)),(k+=u&(1<<w)-1)>l){t.msg="invalid distance too far back",r.mode=30;break t}if(u>>>=w,_-=w,k>(w=a-s)){if((w=k-w)>c&&r.sane){t.msg="invalid distance too far back",r.mode=30;break t}if(x=0,S=f,0===d){if(x+=h-w,w<y){y-=w;do{C[a++]=f[x++]}while(--w);x=a-k,S=C}}else if(d<w){if(x+=h+d-w,(w-=d)<y){y-=w;do{C[a++]=f[x++]}while(--w);if(x=0,d<y){y-=w=d;do{C[a++]=f[x++]}while(--w);x=a-k,S=C}}}else if(x+=d-w,w<y){y-=w;do{C[a++]=f[x++]}while(--w);x=a-k,S=C}for(;y>2;)C[a++]=S[x++],C[a++]=S[x++],C[a++]=S[x++],y-=3;y&&(C[a++]=S[x++],y>1&&(C[a++]=S[x++]))}else{x=a-k;do{C[a++]=C[x++],C[a++]=C[x++],C[a++]=C[x++],y-=3}while(y>2);y&&(C[a++]=C[x++],y>1&&(C[a++]=C[x++]))}break}}break}}while(n<i&&a<o);n-=y=_>>3,u&=(1<<(_-=y<<3))-1,t.next_in=n,t.next_out=a,t.avail_in=n<i?i-n+5:5-(n-i),t.avail_out=a<o?o-a+257:257-(a-o),r.hold=u,r.bits=_}},function(t,e,r){"use strict";var n=r(1),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,r,l,h,c,d,f){var u,_,p,m,g,v,b,w,y,k=f.bits,x=0,S=0,z=0,C=0,L=0,A=0,O=0,E=0,I=0,q=0,j=null,T=0,R=new n.Buf16(16),P=new n.Buf16(16),D=null,N=0;for(x=0;x<=15;x++)R[x]=0;for(S=0;S<l;S++)R[e[r+S]]++;for(L=k,C=15;C>=1&&0===R[C];C--);if(L>C&&(L=C),0===C)return h[c++]=20971520,h[c++]=20971520,f.bits=1,0;for(z=1;z<C&&0===R[z];z++);for(L<z&&(L=z),E=1,x=1;x<=15;x++)if(E<<=1,(E-=R[x])<0)return-1;if(E>0&&(0===t||1!==C))return-1;for(P[1]=0,x=1;x<15;x++)P[x+1]=P[x]+R[x];for(S=0;S<l;S++)0!==e[r+S]&&(d[P[e[r+S]]++]=S);if(0===t?(j=D=d,v=19):1===t?(j=i,T-=257,D=a,N-=257,v=256):(j=s,D=o,v=-1),q=0,S=0,x=z,g=c,A=L,O=0,p=-1,m=(I=1<<L)-1,1===t&&I>852||2===t&&I>592)return 1;for(;;){b=x-O,d[S]<v?(w=0,y=d[S]):d[S]>v?(w=D[N+d[S]],y=j[T+d[S]]):(w=96,y=0),u=1<<x-O,z=_=1<<A;do{h[g+(q>>O)+(_-=u)]=b<<24|w<<16|y|0}while(0!==_);for(u=1<<x-1;q&u;)u>>=1;if(0!==u?(q&=u-1,q+=u):q=0,S++,0==--R[x]){if(x===C)break;x=e[r+d[S]]}if(x>L&&(q&m)!==p){for(0===O&&(O=L),g+=z,E=1<<(A=x-O);A+O<C&&!((E-=R[A+O])<=0);)A++,E<<=1;if(I+=1<<A,1===t&&I>852||2===t&&I>592)return 1;h[p=q&m]=L<<24|A<<16|g-c|0}}return 0!==q&&(h[g+q]=x-O<<24|64<<16|0),f.bits=L,0}},function(t,e,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(t,e,r){"use strict";r.r(e);var n=r(0);r(24);var i=class{constructor(){this.penSizes=[1,2,3,4],this.tools=["Pen tool","Paint bucket tool","Paint all pixels of the same color","Eraser tool","Stroke tool","Rectangle tool","Circle tool","Move tool","Lighten","Dithering tool","Color picker"],this.shortcuts=["P","B","A","E","L","R","C","M","U","T","O"]}static addClassActiveTool(t){const e=document.querySelector(".active--tool");e&&e.classList.remove("active--tool"),t.classList.add("active--tool")}static addClassActiveSize(t){const e=document.querySelector(".active--size");e&&e.classList.remove("active--size"),t.classList.add("active--size")}createPenSizeList(){const t=this.penSizes.map((t,e)=>{const r=`pen-size__item${0===e?" active--size":""}`,i=Object(n.a)("li",r);return i.setAttribute("data-size",t),i}),e=Object(n.a)("div","pen-size__tip","Pen size from 1 to 4 pixels");return Object(n.a)("ul","pen-size__list",...t,e)}createToolsList(){const t=this.tools.map((t,e)=>{const r=Object(n.a)("span","tools__shortcut",`(${this.shortcuts[e]})`),i=Object(n.a)("div","tools__tip",`${t} `,r),a=`tools__item ${t.toLowerCase().split(" ").join("-")}${e?"":" active--tool"}`;return Object(n.a)("li",a,i)});return Object(n.a)("ul","tools__list",...t)}createPalette(){const t=["first-color","second-color"].map((t,e)=>{const r=Object(n.a)("input",`${t}__input`);r.setAttribute("type","color"),r.setAttribute("value",`${0===e?"#000000":"#ffffff"}`);const i=Object(n.a)("div","input__wrapper",r),a=`${0===e?"Primary - left mouse button":"Secondary - right mouse button"} - ${r.value}`,s=Object(n.a)("span","color__tip",a);return Object(n.a)("div",`palette__item ${t}`,i,s)}),e=Object(n.a)("span","swap-colors__shortcut","(X)"),r=Object(n.a)("span","swap-colors__tip","Swap colors ",e),i=Object(n.a)("div","swap-colors",r);return Object(n.a)("div","palette",...t,i)}render(){const t=this.createPenSizeList(),e=this.createToolsList(),r=this.createPalette(),i=Object(n.a)("div","tools__wrapper",t,e,r),a=Object(n.a)("section","tools",i);document.querySelector(".main").append(a)}};r(31);var a=class{constructor(){this.scale=20,this.width=32,this.height=32}static addClassCursor(t){const e=document.querySelector(".canvas__wrapper");e.classList="canvas__wrapper",e.classList.add(`cursor-${t}`)}createCanvas(t,e,r){const i=Object(n.a)("canvas",r);return i.width=t,i.height=e,i}render(){const t=this.createCanvas(this.width,this.height,"canvas__main"),e=this.createCanvas(this.width,this.height,"canvas__drawing");t.style.transform=`scale(${this.scale},${this.scale})`,e.style.transform=`scale(${this.scale},${this.scale})`;const r=Object(n.a)("div","canvas__background");r.style.width=`${this.width*this.scale}px`,r.style.height=`${this.height*this.scale}px`;const i=Object(n.a)("div","canvas__container",r,t,e),a=Object(n.a)("div","canvas__wrapper cursor-pen",i),s=Object(n.a)("span","size",`[${this.width}x${this.height}] `),o=Object(n.a)("span","coords"),l=Object(n.a)("span","frame-number","1/1"),h=Object(n.a)("div","cursor-coordinates",s,o,l),c=Object(n.a)("section","canvas",a,h);document.querySelector(".main").append(c)}},s=r(3);r(46);var o=class{updateFramesNumbers(){const t=document.querySelector(".frames__list"),e=[...t.children];e.forEach(t=>{t.querySelector(".number").innerHTML=t.style.order});const r=t.firstChild.querySelector(".button__delete"),n=t.firstChild.querySelector(".button__move");r.style.display=1===e.length?"none":"",n.style.display=1===e.length?"none":""}createFrameButtons(){const t={button__delete:"Delete this frame",button__copy:"Duplicate this frame",button__number:"Toggle for preview"},e=["button__delete","button__copy","button__move","button__number"].map(e=>{if(t[e]){const r=Object(n.a)("span","button__tip",`${t[e]}`),i="button__number"===e?Object(n.a)("span","number"):"";return Object(n.a)("button",`button ${e}`,r,i)}return Object(n.a)("button",`button ${e}`)});return e.forEach(t=>t.setAttribute("type","button")),e}createFrame(){const t=this.createFrameButtons(),e=Object(n.a)("canvas","frame__canvas");e.width=128,e.height=128;const r=document.querySelector(".frame--active");r&&r.classList.remove("frame--active");const i=document.querySelector(".frames__list"),a=i.children.length+1,s=Object(n.a)("li","frames__item frame--active",e,...t);return s.setAttribute("draggable","true"),s.style.order=a,i.append(s),this.updateFramesNumbers(),s}createButtonNewFrame(){const t=Object(n.a)("button","frames__button","Add new frame");t.setAttribute("type","button");const e=Object(n.a)("div","button__icon");return Object(n.a)("div","button__wrapper",t,e)}render(){const t=Object(n.a)("ul","frames__list"),e=this.createButtonNewFrame(),r=Object(n.a)("section","frames",t,e);document.querySelector(".main").append(r),this.createFrame()}};r(48);var l=class{createAnimationCanvas(){const t=Object(n.a)("canvas","animation__field");t.width=200,t.height=200;const e=Object(n.a)("button","animation__fullscreen");return e.setAttribute("type","button"),e.addEventListener("click",()=>{document.querySelector(".animation__field").requestFullscreen()}),Object(n.a)("div","animation__wrapper",t,e)}createSpeedPanel(){const t=Object(n.a)("input","speed__range");t.setAttribute("type","range"),t.setAttribute("name","speed"),t.setAttribute("value","12"),t.setAttribute("min","0"),t.setAttribute("max","24");const e=Object(n.a)("span","speed__fps");return Object(n.a)("div","speed__wrapper",e,t)}createSizePanel(){const t=Object(n.a)("p","size-field__text","Resize canvas"),e=[32,64,128].map(t=>{const e=32===t?"resize-button resize-button--active":"resize-button",r=Object(n.a)("button",`${e}`,`${t}x${t}`);return r.setAttribute("data-canvas-size",`${t}`),r}),r=Object(n.a)("div","size-field__buttons",...e);return Object(n.a)("div","size-field",t,r)}createDownloaders(){const t=Object(n.a)("button","save-button","Download"),e=Object(n.a)("a","button-gif","GIF");e.setAttribute("download","piskel");const r=Object(n.a)("a","button-apng","APNG");r.setAttribute("download","piskel");const i=Object(n.a)("div","buttons__wrapper",e,r);return Object(n.a)("div","downloaders__wrapper",t,i)}render(){const t=this.createAnimationCanvas(),e=this.createSpeedPanel(),r=this.createSizePanel(),i=this.createDownloaders(),a=Object(n.a)("section","animation",t,e,r,i);document.querySelector(".main").append(a)}};var h=r(10),c=r.n(h),d=r(11),f=r.n(d);class u{constructor(){this.framesView=new o,this.mainCanvas=document.querySelector(".canvas__main"),this.context=this.mainCanvas.getContext("2d"),this.dragSrcEl=null,this.speed=12}showFrameNumber(){const t=document.querySelector(".frame-number"),e=document.querySelector(".frames__list"),r=document.querySelector(".frame--active");t.innerHTML=`${r.style.order}/${e.children.length}`}trackNewFrame(){document.querySelector(".frames__button").addEventListener("click",()=>{const t=this.framesView.createFrame();this.trackMenuFrame(t),this.showFrameNumber(),this.context.clearRect(0,0,this.mainCanvas.width,this.mainCanvas.height)})}trackMenuFrame(t=document){t.querySelector(".button__copy").addEventListener("click",this.copyFrame.bind(this)),t.querySelector(".button__delete").addEventListener("click",this.deleteFrame.bind(this))}trackFrameList(){const t=document.querySelector(".frames__list");t.addEventListener("click",this.changeActiveFrame.bind(this)),t.addEventListener("dragstart",this.dragStartHandler),t.addEventListener("dragenter",this.dragEnterHandle),t.addEventListener("dragover",this.dragOverHandle),t.addEventListener("dragleave",this.dragLeaveHandle),t.addEventListener("drop",this.dropHandle),t.addEventListener("dragend",this.dragEndHandle.bind(this))}startAnimation(){const t=document.querySelector(".animation__field"),e=t.getContext("2d"),r=document.querySelector(".speed__fps");let n,i=0;r.innerHTML=`${this.speed} FRS`;const{width:a,height:s}=t,o=()=>{if(this.speed>0){const t=[...document.querySelector(".frames__list").children];e.clearRect(0,0,a,s),e.imageSmoothingEnabled=!1;const r=t[i%t.length].firstChild;e.drawImage(r,0,0,r.width,r.height,0,0,a,s),i+=1}};n=setInterval(()=>o(),1e3/Number(this.speed));const l=document.querySelector(".speed__range");l.addEventListener("input",()=>{this.speed=l.value,clearInterval(n),n=setInterval(()=>o(),1e3/Number(this.speed)),r.innerHTML=`${this.speed} FRS`})}dragStartHandler(t){const{target:e}=t;e.style.opacity="0.4",this.dragSrcEl=e;const r=t;r.dataTransfer.effectAllowed="move",r.dataTransfer.setData("text/html",e)}dragOverHandle(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="move",!1}dragEnterHandle(t){const{target:e}=t;"canvas"===e.tagName.toLowerCase()&&e.closest(".frames__item").classList.add("over")}dragLeaveHandle(t){const{target:e}=t;"canvas"===e.tagName.toLowerCase()&&e.closest(".frames__item").classList.remove("over")}dropHandle(t){t.stopPropagation&&t.stopPropagation();const{target:e}=t,r=e.closest(".frames__item");if(this.dragSrcEl!==r){const t=this.dragSrcEl.style.order;this.dragSrcEl.style.order=r.style.order,r.style.order=t}return!1}dragEndHandle(t){const e=document.querySelector(".over");e&&e.classList.remove("over");const{target:r}=t;r.style.opacity="",this.framesView.updateFramesNumbers()}exportFile(){document.querySelector(".save-button").addEventListener("click",()=>{const t=document.querySelectorAll(".frame__canvas"),e=document.querySelector(".speed__range"),r=document.querySelector(".button-gif"),n=document.querySelector(".buttons__wrapper"),i=new c.a({workers:2,quality:10,workerScript:"./gif.worker.js",repeat:0,width:t[0].width,height:t[0].height,background:t[0].style.background});t.forEach(t=>i.addFrame(t,{delay:1e3/e.value})),i.on("finished",t=>{n.style.display="flex",r.href=URL.createObjectURL(t)}),i.render(),n.addEventListener("click",()=>{n.style.display="none"})}),document.querySelector(".save-button").addEventListener("click",()=>{const t=[...document.querySelectorAll(".frame__canvas")],e=document.querySelector(".speed__range"),r=document.querySelector(".button-apng"),n=t.map(t=>t.getContext("2d").getImageData(0,0,t.width,t.height).data.buffer),{width:i,height:a}=t[0],s=n.length,o=f.a.encode(n,i,a,0,new Array(s).fill(1e3/e.value)),l=new Blob([o],{type:"image/apng"});r.href=URL.createObjectURL(l)})}static getFrame(){const t=document.querySelector(".frame--active").firstChild,e=t.getContext("2d");e.imageSmoothingEnabled=!1;const r=document.querySelector(".canvas__main"),{width:n,height:i}=r,a=t.width,s=t.height;e.clearRect(0,0,a,s),e.drawImage(r,0,0,n,i,0,0,a,s)}copyFrame(t){const e=this.framesView.createFrame();this.trackMenuFrame(e),this.showFrameNumber();const r=t.target.parentNode.firstChild;e.firstChild.getContext("2d").drawImage(r,0,0)}deleteFrame(t){const e=t.target.closest(".frames__item"),{order:r}=e.style;document.querySelector(".frames__list").removeChild(e);const n=document.querySelector(".frames__list");[...n.children].forEach(t=>{if(t.style.order>r){t.style.order-=1}}),e.classList.contains("frame--active")&&n.lastChild.classList.add("frame--active"),this.framesView.updateFramesNumbers(),this.setFrame(),this.showFrameNumber()}setFrame(){const t=document.querySelector(".frame--active").firstChild,{width:e,height:r}=this.mainCanvas,n=t.width,i=t.height;this.context.clearRect(0,0,e,r),this.context.imageSmoothingEnabled=!1,this.context.drawImage(t,0,0,n,i,0,0,e,r)}changeActiveFrame(t){if("canvas"===t.target.tagName.toLowerCase()){document.querySelector(".frame--active").classList.remove("frame--active"),t.target.parentNode.classList.add("frame--active"),this.setFrame(),this.showFrameNumber()}}start(){this.trackNewFrame(),this.trackMenuFrame(),this.trackFrameList(),this.startAnimation(),this.exportFile()}}var _=function(){let t,e,r,n,i,a,s=!1;const o=(t,e)=>{const s=Math.abs(i-r),o=Math.abs(a-n),l=r<i?1:-1,h=n<a?1:-1;let c=s-o;for(this.drawPixel(i,a,t,!0,e);r!==i||n!==a;){this.drawPixel(r,n,t,!0,e);const i=c;i>-o&&(c-=o,r+=l),i<s&&(c+=s,n+=h)}},l=()=>{s||this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.transferImage(),s&&u.getFrame(),s=!1};this.addListners([i=>{s=!0,[r,n]=[i.offsetX,i.offsetY],t=1===i.which?this.firstColor:this.secondColor,e=1===i.which?this.secondColor:this.firstColor,this.drawPixel(r,n,t,!0,e)},t=>{t.preventDefault()},r=>{if(!s){const[t,e]=[r.offsetX,r.offsetY];return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),void this.drawPixel(t,e,"rgba(179, 179, 179, 0.3)",!1)}[i,a]=[r.offsetX,r.offsetY],o(t,e)},l,l])},p=function(){let t,e,r,n,i,a=!1;const s=t=>{const a=Math.abs(r-e),s=Math.abs(i-n),o=e<r?1:-1,l=n<i?1:-1;let h=a-s;for(this.drawPixel(r,i,t);e!==r||n!==i;){this.drawPixel(e,n,t);const r=2*h;r>-s&&(h-=s,e+=o),r<a&&(h+=a,n+=l)}},o=()=>{a||this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.transferImage(),a&&u.getFrame(),a=!1};this.addListners([r=>{a=!0,t=!0,[e,n]=[r.offsetX,r.offsetY],this.drawPixel(e,n,this.firstColor)},r=>{r.preventDefault(),t=!1,this.drawPixel(e,n,this.secondColor)},e=>{if(!a){const[t,r]=[e.offsetX,e.offsetY];return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),void this.drawPixel(t,r,"rgba(179, 179, 179, 0.3)",!1)}[r,i]=[e.offsetX,e.offsetY],s(t?this.firstColor:this.secondColor)},o,o])},m=function(){let t=!1;const e=(t,e,r)=>{const{data:n}=this.context.getImageData(t,e,1,1);return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]&&n[3]===r[3]},r=(t,r,i,a)=>{if(Object(n.b)([...i].slice(0,-1))===a&&255===i[3])return;let s,o;const l=[[t,r]],h=this.mainCanvas.width,c=this.mainCanvas.height;for(;l.length;){const t=l.pop(),[r]=t;let[,n]=t;for(;n>=0&&e(r,n,i);)n-=1;for(n+=1;n<c&&e(r,n,i);)this.drawPixel(r,n,a),r>0&&(e(r-1,n,i)&&(s||(l.push([r-1,n]),s=!0)),s=!1),r<h&&(e(r+1,n,i)&&(o||(l.push([r+1,n]),o=!0)),o=!1),n+=1;this.transferImage()}};this.addListners([e=>{t=!0;const[n,i]=[e.offsetX,e.offsetY],{data:a}=this.context.getImageData(n,i,1,1);r(n,i,a,1===e.which?this.firstColor:this.secondColor)},t=>{t.preventDefault()},t=>{const[e,r]=[t.offsetX,t.offsetY];this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawPixel(e,r,"rgba(179, 179, 179, 0.3)",!1)},()=>{t&&this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),t=!1,this.transferImage(),u.getFrame()},()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}])},g=function(){let t,e,r=!1;const n=this.mainCanvas.width,i=this.mainCanvas.height,a=(t,e,r)=>{const{data:n}=this.context.getImageData(t,e,1,1);return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]&&n[3]===r[3]},s=(t,e)=>{for(let r=0;r<n;r+=1)for(let n=0;n<i;n+=1)a(r,n,t)&&this.drawPixel(r,n,e)};this.addListners([n=>{r=!0,[t,e]=[n.offsetX,n.offsetY];const{data:i}=this.context.getImageData(t,e,1,1);s(i,1===n.which?this.firstColor:this.secondColor)},t=>{t.preventDefault()},t=>{if(!r){const[e,r]=[t.offsetX,t.offsetY];this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawPixel(e,r,"rgba(179, 179, 179, 0.3)",!1)}},()=>{r=!1,this.transferImage(),u.getFrame()},()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}])},v=function(){let t,e,r,n,i,a=!1;const s=(t,e)=>{let[r,n]=t;const[,,i,a]=t,s=Math.abs(i-r),o=Math.abs(a-n),l=r<i?1:-1,h=n<a?1:-1;let c=s-o;for(this.drawPixel(i,a,e);r!==i||n!==a;){this.drawPixel(r,n,e);const t=c;t>-o&&(c-=o,r+=l),t<s&&(c+=s,n+=h)}},o=()=>{a||this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.transferImage(),a&&u.getFrame(),a=!1,this.ctx.beginPath()};this.addListners([r=>{a=!0,t=!0,[e,n]=[r.offsetX,r.offsetY],this.drawPixel(e,n,this.firstColor)},r=>{r.preventDefault(),t=!1,this.drawPixel(e,n,this.secondColor)},o=>{if(!a){const[t,e]=[o.offsetX,o.offsetY];return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),void this.drawPixel(t,e,"rgba(179, 179, 179, 0.3)")}[r,i]=[o.offsetX,o.offsetY],this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),s([e,n,r,i],t?this.firstColor:this.secondColor)},o,o])},b=function(){let t,e,r,n,i,a=!1;const s=(t,e)=>{let[r,n]=t;const[,,i,a]=t,s=Math.abs(i-r),o=Math.abs(a-n),l=r<i?1:-1,h=n<a?1:-1;let c=s-o;for(this.drawPixel(i,a,e);r!==i||n!==a;){this.drawPixel(r,n,e);const t=c;t>-o&&(c-=o,r+=l),t<s&&(c+=s,n+=h)}},o=()=>{a||this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.transferImage(),a&&u.getFrame(),a=!1,this.ctx.beginPath()};this.addListners([r=>{a=!0,t=!0,[e,n]=[r.offsetX,r.offsetY],this.drawPixel(e,n,this.firstColor)},r=>{r.preventDefault(),t=!1,this.drawPixel(e,n,this.secondColor)},o=>{if(!a){const[t,e]=[o.offsetX,o.offsetY];return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),void this.drawPixel(t,e,"rgba(179, 179, 179, 0.3)")}[r,i]=[o.offsetX,o.offsetY],this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const l=t?this.firstColor:this.secondColor;s([e,n,r,n],l),s([e,n,e,i],l),s([e,i,r,i],l),s([r,n,r,i],l)},o,o])},w=function(){let t,e,r,n,i,a=!1;const s=(t,e,r,n)=>{let i=0,a=r,s=0,o=1-2*r;for(;a>=0;)this.drawPixel(t+i,e-a,n),this.drawPixel(t-i,e-a,n),this.drawPixel(t-i,e+a,n),this.drawPixel(t+i,e+a,n),s=2*(o+a)-1,o<0&&s<=0?o+=2*(i+=1)+1:(s=2*(o-i)-1,o>0&&s>0?o+=1-2*(a-=1):(o+=2*((i+=1)-a),a-=1))},o=()=>{a||this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.transferImage(),a&&u.getFrame(),a=!1};this.addListners([r=>{a=!0,t=!0,[e,n]=[r.offsetX,r.offsetY],this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},e=>{e.preventDefault(),t=!1},o=>{if(!a){const[t,e]=[o.offsetX,o.offsetY];return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),void this.drawPixel(t,e,"rgba(179, 179, 179, 0.3)")}[r,i]=[o.offsetX,o.offsetY];const l=Math.ceil(Math.sqrt((r-e)**2+(i-n)**2));this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),s(e,n,l,t?this.firstColor:this.secondColor)},o,o])},y=function(){let t,e,r,n,i,a=!1;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const s=()=>{a=!1,this.transferImage(),u.getFrame()};this.addListners([e=>{a=!0,[t,r]=[e.offsetX,e.offsetY],i=this.context.getImageData(0,0,this.mainCanvas.width,this.mainCanvas.height)},t=>{t.preventDefault()},s=>{a&&([e,n]=[s.offsetX,s.offsetY],this.context.clearRect(0,0,this.mainCanvas.width,this.mainCanvas.height),this.context.putImageData(i,e-t,n-r))},s,s])},k=function(){let t,e,r=!1;const n=(t,e,r,n)=>{const i=r.data,a=1===n?25:15;i[0]=i[0]<255?i[0]+a:i[0],i[1]=i[1]<255?i[1]+a:i[1],i[2]=i[2]<255?i[2]+a:i[2],this.context.putImageData(r,t,e)},i=()=>{r=!1,this.transferImage(),u.getFrame()};this.addListners([i=>{r=!0,[t,e]=[i.offsetX,i.offsetY];const a=this.context.getImageData(t,e,1,1);n(t,e,a,i.which)},t=>{t.preventDefault()},i=>{if(!r)return;[t,e]=[i.offsetX,i.offsetY];const a=this.context.getImageData(t,e,1,1);n(t,e,a)},i,i])},x=function(){const t=(t,e=!0)=>{const r=[],[i,a]=[t.offsetX,t.offsetY],{data:s}=this.context.getImageData(i,a,1,1);for(let t=0;t<s.length-1;t+=1)r.push(s[t]);e?(this.firstColor=Object(n.b)(r),document.querySelector(".first-color__input").value=this.firstColor):(this.secondColor=Object(n.b)(r),document.querySelector(".second-color__input").value=this.secondColor)};this.canvas.style.display="none";this.mainCanvas.addEventListener("click",e=>{t(e)}),this.mainCanvas.addEventListener("contextmenu",e=>{e.preventDefault(),t(e,!1)})};
/*!
 * hotkeys-js v3.6.10
 * A simple micro-library for defining and dispatching keyboard shortcuts. It has no dependencies.
 * 
 * Copyright (c) 2019 kenny wong <wowohoo@qq.com>
 * http://jaywcjlove.github.io/hotkeys
 * 
 * Licensed under the MIT license.
 */
var S="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function z(t,e,r){t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent&&t.attachEvent("on".concat(e),function(){r(window.event)})}function C(t,e){for(var r=e.slice(0,e.length-1),n=0;n<r.length;n++)r[n]=t[r[n].toLowerCase()];return r}function L(t){t||(t="");for(var e=(t=t.replace(/\s/g,"")).split(","),r=e.lastIndexOf("");r>=0;)e[r-1]+=",",e.splice(r,1),r=e.lastIndexOf("");return e}function A(t,e){for(var r=t.length>=e.length?t:e,n=t.length>=e.length?e:t,i=!0,a=0;a<r.length;a++)-1===n.indexOf(r[a])&&(i=!1);return i}for(var O={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,"":20,",":188,".":190,"/":191,"`":192,"-":S?173:189,"=":S?61:187,";":S?59:186,"'":222,"[":219,"]":221,"\\":220},E={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":S?224:91,cmd:S?224:91,command:S?224:91},I={16:"shiftKey",18:"altKey",17:"ctrlKey"},q={16:!1,18:!1,17:!1},j={},T=1;T<20;T++)O["f".concat(T)]=111+T;I[S?224:91]="metaKey",q[S?224:91]=!1;var R=[],P="all",D=[],N=function(t){return O[t.toLowerCase()]||E[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)};function F(t){P=t||"all"}function B(){return P||"all"}function U(t,e,r){var n;if(e.scope===r||"all"===e.scope){for(var i in n=e.mods.length>0,q)Object.prototype.hasOwnProperty.call(q,i)&&(!q[i]&&e.mods.indexOf(+i)>-1||q[i]&&-1===e.mods.indexOf(+i))&&(n=!1);(0!==e.mods.length||q[16]||q[18]||q[17]||q[91])&&!n&&"*"!==e.shortcut||!1===e.method(t,e)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}function M(t){var e=j["*"],r=t.keyCode||t.which||t.charCode;if(Z.filter.call(this,t)){if(-1===R.indexOf(r)&&229!==r&&R.push(r),93!==r&&224!==r||(r=91),r in q){for(var n in q[r]=!0,E)E[n]===r&&(Z[n]=!0);if(!e)return}for(var i in q)Object.prototype.hasOwnProperty.call(q,i)&&(q[i]=t[I[i]]);var a=B();if(e)for(var s=0;s<e.length;s++)e[s].scope===a&&("keydown"===t.type&&e[s].keydown||"keyup"===t.type&&e[s].keyup)&&U(t,e[s],a);if(r in j)for(var o=0;o<j[r].length;o++)if(("keydown"===t.type&&j[r][o].keydown||"keyup"===t.type&&j[r][o].keyup)&&j[r][o].key){for(var l=j[r][o].key.split("+"),h=[],c=0;c<l.length;c++)h.push(N(l[c]));(h=h.sort()).join("")===R.sort().join("")&&U(t,j[r][o],a)}}}function Z(t,e,r){var n=L(t),i=[],a="all",s=document,o=0,l=!1,h=!0;for(void 0===r&&"function"==typeof e&&(r=e),"[object Object]"===Object.prototype.toString.call(e)&&(e.scope&&(a=e.scope),e.element&&(s=e.element),e.keyup&&(l=e.keyup),e.keydown&&(h=e.keydown)),"string"==typeof e&&(a=e);o<n.length;o++)i=[],(t=n[o].split("+")).length>1&&(i=C(E,t)),(t="*"===(t=t[t.length-1])?"*":N(t))in j||(j[t]=[]),j[t].push({keyup:l,keydown:h,scope:a,mods:i,shortcut:n[o],method:r,key:n[o]});void 0!==s&&!function(t){return D.indexOf(t)>-1}(s)&&window&&(D.push(s),z(s,"keydown",function(t){M(t)}),z(window,"focus",function(){R=[]}),z(s,"keyup",function(t){M(t),function(t){var e=t.keyCode||t.which||t.charCode,r=R.indexOf(e);if(r>=0&&R.splice(r,1),t.key&&"meta"===t.key.toLowerCase()&&R.splice(0,R.length),93!==e&&224!==e||(e=91),e in q)for(var n in q[e]=!1,E)E[n]===e&&(Z[n]=!1)}(t)}))}var $={setScope:F,getScope:B,deleteScope:function(t,e){var r,n;for(var i in t||(t=B()),j)if(Object.prototype.hasOwnProperty.call(j,i))for(r=j[i],n=0;n<r.length;)r[n].scope===t?r.splice(n,1):n++;B()===t&&F(e||"all")},getPressedKeyCodes:function(){return R.slice(0)},isPressed:function(t){return"string"==typeof t&&(t=N(t)),-1!==R.indexOf(t)},filter:function(t){var e=t.target||t.srcElement,r=e.tagName,n=!0;return!e.isContentEditable&&"TEXTAREA"!==r&&("INPUT"!==r&&"TEXTAREA"!==r||e.readOnly)||(n=!1),n},unbind:function(t,e,r){var n,i,a=L(t),s=[];"function"==typeof e&&(r=e,e="all");for(var o=0;o<a.length;o++){if(s=(n=a[o].split("+")).length>1?C(E,n):[],t="*"===(t=n[n.length-1])?"*":N(t),e||(e=B()),!j[t])return;for(var l=0;l<j[t].length;l++)i=j[t][l],(!r||i.method===r)&&i.scope===e&&A(i.mods,s)&&(j[t][l]={})}}};for(var H in $)Object.prototype.hasOwnProperty.call($,H)&&(Z[H]=$[H]);if("undefined"!=typeof window){var X=window.hotkeys;Z.noConflict=function(t){return t&&window.hotkeys===Z&&(window.hotkeys=X),Z},window.hotkeys=Z}var Y=Z;(new class{constructor(){this.toolsView=new i,this.canvasView=new a,this.piskelView=new s.a("New Piskel"),this.framesView=new o,this.animationView=new l}start(){this.piskelView.render(),this.toolsView.render(),this.framesView.render(),this.canvasView.render(),this.animationView.render()}}).start(),(new class{constructor(){this.canvas=document.querySelector(".canvas__drawing"),this.mainCanvas=document.querySelector(".canvas__main"),this.ctx=this.canvas.getContext("2d"),this.context=this.mainCanvas.getContext("2d"),this.currentTool="pen",this.pixelSize=1,this.scale=20,this.toolsList=document.querySelector(".tools__list"),this.tools={pen:document.querySelector(".pen-tool"),bucket:document.querySelector(".paint-bucket-tool"),colorSwap:document.querySelector(".paint-all-pixels-of-the-same-color"),eraser:document.querySelector(".eraser-tool"),stroke:document.querySelector(".stroke-tool"),rectangle:document.querySelector(".rectangle-tool"),circle:document.querySelector(".circle-tool"),move:document.querySelector(".move-tool"),lighten:document.querySelector(".lighten"),dithering:document.querySelector(".dithering-tool"),picker:document.querySelector(".color-picker")},this.handlers={pen:()=>p.call(this),bucket:()=>m.call(this),colorSwap:()=>g.call(this),eraser:()=>p.call(this),stroke:()=>v.call(this),rectangle:()=>b.call(this),circle:()=>w.call(this),move:()=>y.call(this),lighten:()=>k.call(this),dithering:()=>_.call(this),picker:()=>x.call(this)},this.listners={},this.events=["mousedown","contextmenu","mousemove","mouseup","mouseleave"],this.firstColor=document.querySelector(".first-color__input").value,this.secondColor=document.querySelector(".second-color__input").value,this.scales={32:20,64:10,128:5}}showCursorCoords(){const t=document.querySelector(".coords");[this.canvas,this.mainCanvas].forEach(e=>{e.addEventListener("mousemove",e=>{t.innerHTML=`${e.offsetX}:${e.offsetY}`}),e.addEventListener("mouseleave",()=>{t.innerHTML=""})})}setTool(){this.toolsList.addEventListener("click",({target:t})=>{"LI"===t.tagName&&(this.canvas.style.display="",[this.currentTool]=Object.keys(this.tools).filter(e=>this.tools[e]===t),i.addClassActiveTool(t),a.addClassCursor(this.currentTool),this.removeListners(),this.handlers[this.currentTool]())}),this.handlers[this.currentTool]()}setPixelWidth(){document.querySelector(".pen-size__list").addEventListener("click",({target:t})=>{"LI"===t.tagName&&(this.pixelSize=Number(t.dataset.size),i.addClassActiveSize(t))})}resize(){document.querySelector(".size-field__buttons").addEventListener("click",({target:t})=>{if("button"!==t.tagName.toLowerCase())return;const e=document.querySelector(".resize-button--active");e&&e.classList.remove("resize-button--active"),t.classList.add("resize-button--active");const r=t.dataset.canvasSize,n=this.mainCanvas.width;this.mainCanvas.style.setProperty("--width",`${r}px`),this.canvas.style.setProperty("--width",`${r}px`),this.scale=this.scales[r];const i=this.context.getImageData(0,0,this.mainCanvas.width,this.mainCanvas.height);this.mainCanvas.width=r,this.mainCanvas.height=r;const a=(r-n)/2;this.context.putImageData(i,a,a),this.canvas.width=r,this.canvas.height=r;const s=document.querySelector(".canvas__background");s.style.width=`${r*this.scale}px`,s.style.height=`${r*this.scale}px`,this.canvas.style.transform=`scale(${this.scale},${this.scale})`,this.mainCanvas.style.transform=`scale(${this.scale},${this.scale})`,document.querySelector(".size").innerHTML=`[${r}x${r}] `,u.getFrame()})}setColors(){const t=document.querySelector(".first-color__input"),e=document.querySelector(".second-color__input"),r=document.querySelector(".swap-colors");t.addEventListener("input",({target:t})=>{this.firstColor=t.value}),e.addEventListener("input",({target:t})=>{this.secondColor=t.value}),r.addEventListener("click",()=>{[this.firstColor,this.secondColor]=[this.secondColor,this.firstColor],[t.value,e.value]=[e.value,t.value]})}addListners(t){this.events.forEach((e,r)=>{this.canvas.addEventListener(e,t[r]),this.listners[e]=t[r]})}removeListners(){Object.keys(this.listners).forEach(t=>this.canvas.removeEventListener(t,this.listners[t])),this.listners={}}drawPixel(t,e,r,n=!0,i){({1:[[0,0]],2:[[-1,-1],[0,-1],[-1,0],[0,0]],3:[[-1,-1],[0,-1],[-1,0],[0,0],[1,-1],[1,0],[1,1],[0,1],[-1,1]],4:[[-1,-1],[0,-1],[-1,0],[0,0],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-2,1],[-2,0],[-2,-1],[-2,-2],[-1,-2],[0,-2],[1,-2]]})[this.pixelSize].forEach(a=>{const[s,o]=a,[l,h]=[t+s,e+o];"eraser"===this.currentTool&&n?(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.clearRect(l,h,1,1)):(this.ctx.fillStyle="dithering"===this.currentTool?((t,e)=>(t+e)%2==0?r:i)(l,h):r,this.ctx.fillRect(l,h,1,1))})}transferImage(){const{width:t}=this.canvas,{height:e}=this.canvas;this.context.drawImage(this.canvas,0,0,t,e,0,0,t,e),this.ctx.clearRect(0,0,t,e)}start(){this.setTool(),this.setPixelWidth(),this.setColors(),this.resize(),this.showCursorCoords()}}).start(),(new u).start(),(new class{start(){Y("p",t=>{t.preventDefault(),document.querySelector(".pen-tool").click()}),Y("b",t=>{t.preventDefault(),document.querySelector(".paint-bucket-tool").click()}),Y("a",t=>{t.preventDefault(),document.querySelector(".paint-all-pixels-of-the-same-color").click()}),Y("e",t=>{t.preventDefault(),document.querySelector(".eraser-tool").click()}),Y("l",t=>{t.preventDefault(),document.querySelector(".stroke-tool").click()}),Y("r",t=>{t.preventDefault(),document.querySelector(".rectangle-tool").click()}),Y("c",t=>{t.preventDefault(),document.querySelector(".circle-tool").click()}),Y("m",t=>{t.preventDefault(),document.querySelector(".move-tool").click()}),Y("u",t=>{t.preventDefault(),document.querySelector(".lighten").click()}),Y("t",t=>{t.preventDefault(),document.querySelector(".dithering-tool").click()}),Y("o",t=>{t.preventDefault(),document.querySelector(".color-picker").click()})}}).start(),(new class{constructor(){this.state={userName:null,userImage:null}}setData(t){document.querySelector(".sign-in").style.display="none",document.querySelector(".signIn").style.display="none",document.querySelector(".login").style.display="flex",document.querySelector(".logout").style.display="block",document.querySelector(".img-login").src=t.userImage,document.querySelector(".user-name").innerHTML=t.userName,localStorage.setItem("state",JSON.stringify(t))}start(){const t=JSON.parse(localStorage.getItem("state"));t&&this.setData(t),document.querySelector(".signIn").addEventListener("click",(async()=>{const t=window.gapi.auth2.getAuthInstance(),e=(await t.signIn()).getBasicProfile();this.state.userName=e.getName(),this.state.userImage=e.getImageUrl(),this.setData(this.state)}).bind(this)),document.querySelector(".logout").addEventListener("click",(async()=>{const t=window.gapi.auth2.getAuthInstance();await t.signOut(),document.querySelector(".sign-in").style.display="flex",document.querySelector(".signIn").style.display="block",document.querySelector(".login").style.display="none",document.querySelector(".logout").style.display="none",this.state.userName=null,this.state.userImage=null,localStorage.clear()}).bind(this))}}).start()},,function(t,e){},,,,,,,function(t,e){},,,,,,,,,,,,,function(t,e){},,function(t,e){},,function(t,e){}]);
//# sourceMappingURL=app.bundle.js.map